<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   hsearch(3) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="hsearch(3) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="hsearch.3" name="hsearch.3" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     hcreate, hdestroy, hsearch, hcreate_r, hdestroy_r,
      hsearch_r &mdash; hash table management
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="funcsynopsis">
     <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;search.h&gt;
</pre>
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          hcreate
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        size_t
        <var class="pdparam">
         nel
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         ENTRY
            *
         <strong>
          hsearch
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        ENTRY
        <var class="pdparam">
         item
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        ACTION
        <var class="pdparam">
         action
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         void
         <strong>
          hdestroy
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        <code>
         void)
        </code>
        ;
       </td>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">

#define _GNU_SOURCE          /* See feature_test_macros(7) */
#include &lt;search.h&gt;
</pre>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          hcreate_r
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        size_t
        <var class="pdparam">
         nel
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        struct hsearch_data *
        <var class="pdparam">
         htab
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          hsearch_r
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        ENTRY
        <var class="pdparam">
         item
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        ACTION
        <var class="pdparam">
         action
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        ENTRY **
        <var class="pdparam">
         retval
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        struct hsearch_data *
        <var class="pdparam">
         htab
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         void
         <strong>
          hdestroy_r
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        struct hsearch_data *
        <var class="pdparam">
         htab
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
   </div>
   <div class="refsect1">
    <a id="hsearch-3_sect1" name="hsearch-3_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     The three functions
     <code class="function">
      hcreate
     </code>
     (),
     <code class="function">
      hsearch
     </code>
     (), and
     <code class="function">
      hdestroy
     </code>
     () allow the caller to create and
      manage a hash search table containing entries consisting of a
      key (a string) and associated data. Using these functions,
      only one hash table can be used at a time.
    </p>
    <p>
     The three functions
     <code class="function">
      hcreate_r
     </code>
     (),
     <code class="function">
      hsearch_r
     </code>
     (),
     <code class="function">
      hdestroy_r
     </code>
     () are reentrant versions that
      allow a program to use more than one hash search table at the
      same time. The last argument,
     <em class="parameter">
      <code>
       htab
      </code>
     </em>
     , points to a structure
      that describes the table on which the function is to operate.
      The programmer should treat this structure as opaque (i.e.,
      do not attempt to directly access or modify the fields in
      this structure).
    </p>
    <p>
     First a hash table must be created using
     <code class="function">
      hcreate
     </code>
     (). The argument
     <em class="parameter">
      <code>
       nel
      </code>
     </em>
     specifies the maximum
      number of entries in the table. (This maximum cannot be
      changed later, so choose it wisely.) The implementation may
      adjust this value upward to improve the performance of the
      resulting hash table.
    </p>
    <p>
     The
     <code class="function">
      hcreate_r
     </code>
     () function
      performs the same task as
     <code class="function">
      hcreate
     </code>
     (), but for the table described by
      the structure *
     <em class="parameter">
      <code>
       htab
      </code>
     </em>
     .
      The structure pointed to by
     <em class="parameter">
      <code>
       htab
      </code>
     </em>
     must be zeroed before the
      first call to
     <code class="function">
      hcreate_r
     </code>
     ().
    </p>
    <p>
     The function
     <code class="function">
      hdestroy
     </code>
     ()
      frees the memory occupied by the hash table that was created
      by
     <code class="function">
      hcreate
     </code>
     (). After calling
     <code class="function">
      hdestroy
     </code>
     () a new hash table can
      be created using
     <code class="function">
      hcreate
     </code>
     (). The
     <code class="function">
      hdestroy_r
     </code>
     () function performs
      the analogous task for a hash table described by *
     <em class="parameter">
      <code>
       htab
      </code>
     </em>
     , which was previously
      created using
     <code class="function">
      hcreate_r
     </code>
     ().
    </p>
    <p>
     The
     <code class="function">
      hsearch
     </code>
     () function
      searches the hash table for an item with the same key as
     <em class="parameter">
      <code>
       item
      </code>
     </em>
     (where "the
      same" is determined using
     <a class="link" href="../htmlman3/strcmp.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        strcmp
       </span>
       (3)
      </span>
     </a>
     ), and if
      successful returns a pointer to it.
    </p>
    <p>
     The argument
     <em class="parameter">
      <code>
       item
      </code>
     </em>
     is of type
     <code class="constant">
      ENTRY
     </code>
     , which is
      defined in
     <code class="literal">
      &lt;
     </code>
     <code class="filename">
      search.h
     </code>
     <code class="literal">
      &gt;
     </code>
     as follows:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="structdef">
       <table style="border-collapse: collapse;">
        <colgroup span="1">
         <col class="c1" span="1">
         </col>
         <col class="c2" span="1">
         </col>
         <col class="c3" span="1">
         </col>
         <col class="c4" span="1">
         </col>
         <col class="c5" span="1">
         </col>
        </colgroup>
        <tbody>
         <tr>
          <td align="left" class="structdefhdr" colspan="1" rowspan="1" style="">
           typedef
          </td>
          <td align="left" class="structdefhdr" colspan="4" rowspan="1" style="">
           struct&nbsp;
           <span class="structname">
            entry
           </span>
           &nbsp;{
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            char
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           *
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             key
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            void
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           *
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             data
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
           } ENTRY;
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </blockquote>
    </div>
    <p>
     The field
     <em class="parameter">
      <code>
       key
      </code>
     </em>
     points to a null-terminated string which is the search key.
      The field
     <em class="parameter">
      <code>
       data
      </code>
     </em>
     points
      to data that is associated with that key.
    </p>
    <p>
     The argument
     <em class="parameter">
      <code>
       action
      </code>
     </em>
     determines what
     <code class="function">
      hsearch
     </code>
     () does after an
      unsuccessful search. This argument must either have the value
     <code class="constant">
      ENTER
     </code>
     , meaning insert a copy of
     <em class="parameter">
      <code>
       item
      </code>
     </em>
     (and return a
      pointer to the new hash table entry as the function result),
      or the value
     <code class="constant">
      FIND
     </code>
     , meaning that
      NULL should be returned. (If
     <em class="parameter">
      <code>
       action
      </code>
     </em>
     is
     <code class="constant">
      FIND
     </code>
     , then
     <em class="parameter">
      <code>
       data
      </code>
     </em>
     is ignored.)
    </p>
    <p>
     The
     <code class="function">
      hsearch_r
     </code>
     () function is
      like
     <code class="function">
      hsearch
     </code>
     () but operates on
      the hash table described by *
     <em class="parameter">
      <code>
       htab
      </code>
     </em>
     . The
     <code class="function">
      hsearch_r
     </code>
     () function differs from
     <code class="function">
      hsearch
     </code>
     () in that a pointer to
      the found item is returned in *
     <em class="parameter">
      <code>
       retval
      </code>
     </em>
     , rather than as the
      function result.
    </p>
   </div>
   <div class="refsect1">
    <a id="hsearch-3_sect2" name="hsearch-3_sect2" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     <code class="function">
      hcreate
     </code>
     () and
     <code class="function">
      hcreate_r
     </code>
     () return nonzero on success. They
      return 0 on error, with
     <code class="varname">
      errno
     </code>
     set to indicate the cause of the error.
    </p>
    <p>
     On success,
     <code class="function">
      hsearch
     </code>
     ()
      returns a pointer to an entry in the hash table.
     <code class="function">
      hsearch
     </code>
     () returns NULL on error, that is,
      if
     <em class="parameter">
      <code>
       action
      </code>
     </em>
     is
     <code class="constant">
      ENTER
     </code>
     and the hash table is
      full, or
     <em class="parameter">
      <code>
       action
      </code>
     </em>
     is
     <code class="constant">
      FIND
     </code>
     and
     <em class="parameter">
      <code>
       item
      </code>
     </em>
     cannot be found in the
      hash table.
     <code class="function">
      hsearch_r
     </code>
     () returns
      nonzero on success, and 0 on error. In the event of an error,
      these two functions set
     <code class="varname">
      errno
     </code>
     to
      indicate the cause of the error.
    </p>
   </div>
   <div class="refsect1">
    <a id="hsearch-3_sect3" name="hsearch-3_sect3" shape="rect">
    </a>
    <h2>
     ERRORS
    </h2>
    <p>
     <code class="function">
      hcreate_r
     </code>
     () and
     <code class="function">
      hdestroy_r
     </code>
     () can fail for the following
      reasons:
    </p>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <span class="errorname">
         EINVAL
        </span>
       </span>
      </dt>
      <dd>
       <p>
        <em class="parameter">
         <code>
          htab
         </code>
        </em>
        is
            NULL.
       </p>
      </dd>
     </dl>
    </div>
    <p>
     <code class="function">
      hsearch
     </code>
     () and
     <code class="function">
      hsearch_r
     </code>
     () can fail for the following
      reasons:
    </p>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <span class="errorname">
         ENOMEM
        </span>
       </span>
      </dt>
      <dd>
       <p>
        <em class="parameter">
         <code>
          action
         </code>
        </em>
        was
        <code class="constant">
         ENTER
        </code>
        ,
        <em class="parameter">
         <code>
          key
         </code>
        </em>
        was not found in the
            table, and there was no room in the table to add a new
            entry.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         ESRCH
        </span>
       </span>
      </dt>
      <dd>
       <p>
        <em class="parameter">
         <code>
          action
         </code>
        </em>
        was
        <code class="constant">
         FIND
        </code>
        , and
        <em class="parameter">
         <code>
          key
         </code>
        </em>
        was not found in the
            table.
       </p>
      </dd>
     </dl>
    </div>
    <p>
     POSIX.1-2001 specifies only the
     <span class="errorname">
      ENOMEM
     </span>
     error.
    </p>
   </div>
   <div class="refsect1">
    <a id="hsearch-3_sect4" name="hsearch-3_sect4" shape="rect">
    </a>
    <h2>
     ATTRIBUTES
    </h2>
    <div class="refsect2">
     <a id="hsearch-3_sect5" name="hsearch-3_sect5" shape="rect">
     </a>
     <h3>
      Multithreading (see pthreads(7))
     </h3>
     <p>
      The
      <code class="function">
       hcreate
      </code>
      (),
      <code class="function">
       hsearch
      </code>
      (), and
      <code class="function">
       hdestroy
      </code>
      () functions use a global space
        for storing the table, so they are not thread-safe.
     </p>
     <p>
      The
      <code class="function">
       hcreate_r
      </code>
      (),
      <code class="function">
       hsearch_r
      </code>
      (), and
      <code class="function">
       hdestroy_r
      </code>
      () functions are
        thread-safe.
     </p>
    </div>
   </div>
   <div class="refsect1">
    <a id="hsearch-3_sect6" name="hsearch-3_sect6" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     The functions
     <code class="function">
      hcreate
     </code>
     (),
     <code class="function">
      hsearch
     </code>
     (), and
     <code class="function">
      hdestroy
     </code>
     () are from SVr4, and are described
      in POSIX.1-2001. The functions
     <code class="function">
      hcreate_r
     </code>
     (),
     <code class="function">
      hsearch_r
     </code>
     (), and
     <code class="function">
      hdestroy_r
     </code>
     () are GNU extensions.
    </p>
   </div>
   <div class="refsect1">
    <a id="hsearch-3_sect7" name="hsearch-3_sect7" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     Hash table implementations are usually more efficient when
      the table contains enough free space to minimize collisions.
      Typically, this means that
     <em class="parameter">
      <code>
       nel
      </code>
     </em>
     should be at least 25%
      larger than the maximum number of elements that the caller
      expects to store in the table.
    </p>
    <p>
     The
     <code class="function">
      hdestroy
     </code>
     () and
     <code class="function">
      hdestroy_r
     </code>
     () functions do not
      free the buffers pointed to by the
     <em class="parameter">
      <code>
       key
      </code>
     </em>
     and
     <em class="parameter">
      <code>
       data
      </code>
     </em>
     elements of the hash table
      entries. (It can't do this because it doesn't know whether
      these buffers were allocated dynamically.) If these buffers
      need to be freed (perhaps because the program is repeatedly
      creating and destroying hash tables, rather than creating a
      single table whose lifetime matches that of the program),
      then the program must maintain bookkeeping data structures
      that allow it to free them.
    </p>
   </div>
   <div class="refsect1">
    <a id="hsearch-3_sect8" name="hsearch-3_sect8" shape="rect">
    </a>
    <h2>
     BUGS
    </h2>
    <p>
     SVr4 and POSIX.1-2001 specify that
     <em class="parameter">
      <code>
       action
      </code>
     </em>
     is significant only for
      unsuccessful searches, so that an
     <code class="constant">
      ENTER
     </code>
     should not do anything for a
      successful search. In libc and glibc (before version 2.3),
      the implementation violates the specification, updating the
     <em class="parameter">
      <code>
       data
      </code>
     </em>
     for the given
     <em class="parameter">
      <code>
       key
      </code>
     </em>
     in this case.
    </p>
    <p>
     Individual hash table entries can be added, but not
      deleted.
    </p>
   </div>
   <div class="refsect1">
    <a id="hsearch-3_sect9" name="hsearch-3_sect9" shape="rect">
    </a>
    <h2>
     EXAMPLE
    </h2>
    <p>
     The following program inserts 24 items into a hash table,
      then prints some of them.
    </p>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;search.h&gt;

static char *data[] = { "alpha", "bravo", "charlie", "delta",
     "echo", "foxtrot", "golf", "hotel", "india", "juliet",
     "kilo", "lima", "mike", "november", "oscar", "papa",
     "quebec", "romeo", "sierra", "tango", "uniform",
     "victor", "whisky", "x&minus;ray", "yankee", "zulu"
};

int
main(void)
{
    ENTRY e, *ep;
    int i;

    hcreate(30);

    for (i = 0; i &lt; 24; i++) {
        e.key = data[i];
        /* data is just an integer, instead of a
           pointer to something */
        e.data = (void *) i;
        ep = hsearch(e, ENTER);
        /* there should be no failures */
        if (ep == NULL) {
            fprintf(stderr, "entry failed\n");
            exit(EXIT_FAILURE);
        }
    }

    for (i = 22; i &lt; 26; i++) {
        /* print two entries from the table, and
           show that two are not in the table */
        e.key = data[i];
        ep = hsearch(e, FIND);
        printf("%9.9s &minus;&gt; %9.9s:%d\n", e.key,
               ep ? ep&minus;&gt;key : "NULL", ep ? (int)(ep&minus;&gt;data) : 0);
    }
    hdestroy();
    exit(EXIT_SUCCESS);
}
</pre>
    </div>
   </div>
   <div class="refsect1">
    <a id="hsearch-3_sect10" name="hsearch-3_sect10" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman3/bsearch.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        bsearch
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/lsearch.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        lsearch
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/malloc.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        malloc
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/tsearch.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        tsearch
       </span>
       (3)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="hsearch-3_sect11" name="hsearch-3_sect11" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
