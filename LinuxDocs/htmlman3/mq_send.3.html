<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   mq_send(3) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="mq_send(3) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="mq-send.3" name="mq-send.3" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     mq_send, mq_timedsend &mdash; send a message to a message
      queue
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="funcsynopsis">
     <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;mqueue.h&gt;
</pre>
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          mq_send
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        mqd_t
        <var class="pdparam">
         mqdes
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         msg_ptr
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        size_t
        <var class="pdparam">
         msg_len
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        unsigned int
        <var class="pdparam">
         msg_prio
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">

#include &lt;time.h&gt;
#include &lt;mqueue.h&gt;
</pre>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          mq_timedsend
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        mqd_t
        <var class="pdparam">
         mqdes
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         msg_ptr
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        size_t
        <var class="pdparam">
         msg_len
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        unsigned int
        <var class="pdparam">
         msg_prio
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const struct timespec *
        <var class="pdparam">
         abs_timeout
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
     <table border="0" summary="Note">
      <tr>
       <td align="center" colspan="1" rowspan="2" valign="top" width="25">
        <img alt="[Note]" src="../stylesheet/note.png"/>
       </td>
       <th align="left" colspan="1" rowspan="1">
        Note
       </th>
      </tr>
      <tr>
       <td align="left" colspan="1" rowspan="1" valign="top">
        <div class="featuretests">
         <table style="border-collapse: collapse;">
          <colgroup span="1">
           <col span="1">
           </col>
          </colgroup>
          <thead>
           <tr>
            <th colspan="1" rowspan="1" style="">
             Feature Test Macro Requirements
                      for glibc (see
             <a class="link" href="../htmlman7/feature_test_macros.7.html" shape="rect" target="_top">
              <span class="citerefentry">
               <span class="refentrytitle">
                feature_test_macros
               </span>
               (7)
              </span>
             </a>
             ):
            </th>
           </tr>
          </thead>
          <tbody>
           <tr>
            <td colspan="1" rowspan="1" style="">
             <code class="function">
              mq_timedsend
             </code>
             ():
            </td>
           </tr>
           <tr>
            <td class="featuretestdef" colspan="1" rowspan="1" style="">
             <code class="constant">
              _XOPEN_SOURCE
             </code>
             &gt;= 600 ||
             <code class="constant">
              _POSIX_C_SOURCE
             </code>
             &gt;=
                      200112L
            </td>
           </tr>
          </tbody>
         </table>
        </div>
       </td>
      </tr>
     </table>
    </div>
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
     <table border="0" summary="Note">
      <tr>
       <td align="center" colspan="1" rowspan="2" valign="top" width="25">
        <img alt="[Note]" src="../stylesheet/note.png"/>
       </td>
       <th align="left" colspan="1" rowspan="1">
        Note
       </th>
      </tr>
      <tr>
       <td align="left" colspan="1" rowspan="1" valign="top">
        <p>
         Link with
         <code class="option">
          &minus;lrt
         </code>
         .
        </p>
       </td>
      </tr>
     </table>
    </div>
   </div>
   <div class="refsect1">
    <a id="mq-send-3_sect1" name="mq-send-3_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     <code class="function">
      mq_send
     </code>
     () adds the message
      pointed to by
     <em class="parameter">
      <code>
       msg_ptr
      </code>
     </em>
     to the message queue referred to by the descriptor
     <em class="parameter">
      <code>
       mqdes
      </code>
     </em>
     . The
     <em class="parameter">
      <code>
       msg_len
      </code>
     </em>
     argument specifies the
      length of the message pointed to by
     <em class="parameter">
      <code>
       msg_ptr
      </code>
     </em>
     ; this length must be
      less than or equal to the queue's
     <code class="constant">
      mq_msgsize
     </code>
     attribute. Zero-length messages
      are allowed.
    </p>
    <p>
     The
     <em class="parameter">
      <code>
       msg_prio
      </code>
     </em>
     argument is a nonnegative integer that specifies the priority
      of this message. Messages are placed on the queue in
      decreasing order of priority, with newer messages of the same
      priority being placed after older messages with the same
      priority.
    </p>
    <p>
     If the message queue is already full (i.e., the number of
      messages on the queue equals the queue's
     <code class="constant">
      mq_maxmsg
     </code>
     attribute), then, by default,
     <code class="function">
      mq_send
     </code>
     () blocks until
      sufficient space becomes available to allow the message to be
      queued, or until the call is interrupted by a signal handler.
      If the
     <code class="constant">
      O_NONBLOCK
     </code>
     flag is
      enabled for the message queue description, then the call
      instead fails immediately with the error
     <span class="errorname">
      EAGAIN
     </span>
     .
    </p>
    <p>
     <code class="function">
      mq_timedsend
     </code>
     () behaves just
      like
     <code class="function">
      mq_send
     </code>
     (), except that if
      the queue is full and the
     <code class="constant">
      O_NONBLOCK
     </code>
     flag is not enabled for the
      message queue description, then
     <em class="parameter">
      <code>
       abs_timeout
      </code>
     </em>
     points to a
      structure which specifies a ceiling on the time for which the
      call will block. This ceiling is an absolute timeout in
      seconds and nanoseconds since the Epoch, 1970-01-01 00:00:00
      +0000 (UTC), and it is specified in the following
      structure:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="structdef">
       <table style="border-collapse: collapse;">
        <colgroup span="1">
         <col class="c1" span="1">
         </col>
         <col class="c2" span="1">
         </col>
         <col class="c3" span="1">
         </col>
         <col class="c4" span="1">
         </col>
         <col class="c5" span="1">
         </col>
        </colgroup>
        <tbody>
         <tr>
          <td align="left" class="structdefhdr" colspan="1" rowspan="1" style="">
           struct
          </td>
          <td align="left" class="structdefhdr" colspan="4" rowspan="1" style="">
           <span class="structname">
            timespec
           </span>
           &nbsp;{
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            time_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             tv_sec
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;seconds&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            long
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             tv_nsec
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;nanoseconds&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
           };
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </blockquote>
    </div>
    <p>
     If the message queue is full, and the timeout has already
      expired by the time of the call,
     <code class="function">
      mq_timedsend
     </code>
     () returns immediately.
    </p>
   </div>
   <div class="refsect1">
    <a id="mq-send-3_sect2" name="mq-send-3_sect2" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     On success,
     <code class="function">
      mq_send
     </code>
     () and
     <code class="function">
      mq_timedsend
     </code>
     () return zero; on
      error, &minus;1 is returned, with
     <code class="varname">
      errno
     </code>
     set to indicate the error.
    </p>
   </div>
   <div class="refsect1">
    <a id="mq-send-3_sect3" name="mq-send-3_sect3" shape="rect">
    </a>
    <h2>
     ERRORS
    </h2>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <span class="errorname">
         EAGAIN
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The queue was full, and the
        <code class="constant">
         O_NONBLOCK
        </code>
        flag was set for the
            message queue description referred to by
        <em class="parameter">
         <code>
          mqdes
         </code>
        </em>
        .
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EBADF
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The descriptor specified in
        <em class="parameter">
         <code>
          mqdes
         </code>
        </em>
        was invalid.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EINTR
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The call was interrupted by a signal handler; see
        <a class="link" href="../htmlman7/signal.7.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           signal
          </span>
          (7)
         </span>
        </a>
        .
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EINVAL
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The call would have blocked, and
        <em class="parameter">
         <code>
          abs_timeout
         </code>
        </em>
        was invalid,
            either because
        <em class="parameter">
         <code>
          tv_sec
         </code>
        </em>
        was less than
            zero, or because
        <em class="parameter">
         <code>
          tv_nsec
         </code>
        </em>
        was less than
            zero or greater than 1000 million.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EMSGSIZE
        </span>
       </span>
      </dt>
      <dd>
       <p>
        <em class="parameter">
         <code>
          msg_len
         </code>
        </em>
        was
            greater than the
        <code class="constant">
         mq_msgsize
        </code>
        attribute of the message
            queue.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         ETIMEDOUT
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The call timed out before a message could be
            transferred.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1">
    <a id="mq-send-3_sect4" name="mq-send-3_sect4" shape="rect">
    </a>
    <h2>
     ATTRIBUTES
    </h2>
    <div class="refsect2">
     <a id="mq-send-3_sect5" name="mq-send-3_sect5" shape="rect">
     </a>
     <h3>
      Multithreading (see pthreads(7))
     </h3>
     <p>
      The
      <code class="function">
       mq_send
      </code>
      () and
      <code class="function">
       mq_timedsend
      </code>
      () functions are
        thread-safe.
     </p>
    </div>
   </div>
   <div class="refsect1">
    <a id="mq-send-3_sect6" name="mq-send-3_sect6" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     POSIX.1-2001.
    </p>
   </div>
   <div class="refsect1">
    <a id="mq-send-3_sect7" name="mq-send-3_sect7" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     On Linux,
     <code class="function">
      mq_timedsend
     </code>
     () is
      a system call, and
     <code class="function">
      mq_send
     </code>
     () is
      a library function layered on top of that system call.
    </p>
   </div>
   <div class="refsect1">
    <a id="mq-send-3_sect8" name="mq-send-3_sect8" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman3/mq_close.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        mq_close
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/mq_getattr.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        mq_getattr
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/mq_notify.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        mq_notify
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/mq_open.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        mq_open
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/mq_receive.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        mq_receive
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/mq_unlink.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        mq_unlink
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/mq_overview.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        mq_overview
       </span>
       (7)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/time.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        time
       </span>
       (7)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="mq-send-3_sect9" name="mq-send-3_sect9" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
