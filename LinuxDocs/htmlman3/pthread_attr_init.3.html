<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   pthread_attr_init(3) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="pthread_attr_init(3) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="pthread-attr-init.3" name="pthread-attr-init.3" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     pthread_attr_init, pthread_attr_destroy &mdash; initialize
      and destroy thread attributes object
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="funcsynopsis">
     <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;pthread.h&gt;
</pre>
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          pthread_attr_init
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        pthread_attr_t *
        <var class="pdparam">
         attr
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          pthread_attr_destroy
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        pthread_attr_t *
        <var class="pdparam">
         attr
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
     <table border="0" summary="Note">
      <tr>
       <td align="center" colspan="1" rowspan="2" valign="top" width="25">
        <img alt="[Note]" src="../stylesheet/note.png"/>
       </td>
       <th align="left" colspan="1" rowspan="1">
        Note
       </th>
      </tr>
      <tr>
       <td align="left" colspan="1" rowspan="1" valign="top">
        <p>
         Compile and link with
         <code class="option">
          &minus;pthread
         </code>
         .
        </p>
       </td>
      </tr>
     </table>
    </div>
   </div>
   <div class="refsect1">
    <a id="pthread-attr-init-3_sect1" name="pthread-attr-init-3_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     The
     <code class="function">
      pthread_attr_init
     </code>
     ()
      function initializes the thread attributes object pointed to
      by
     <em class="parameter">
      <code>
       attr
      </code>
     </em>
     with default
      attribute values. After this call, individual attributes of
      the object can be set using various related functions (listed
      under SEE ALSO), and then the object can be used in one or
      more
     <a class="link" href="../htmlman3/pthread_create.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_create
       </span>
       (3)
      </span>
     </a>
     calls
      that create threads.
    </p>
    <p>
     Calling
     <code class="function">
      pthread_attr_init
     </code>
     ()
      on a thread attributes object that has already been
      initialized results in undefined behavior.
    </p>
    <p>
     When a thread attributes object is no longer required, it
      should be destroyed using the
     <code class="function">
      pthread_attr_destroy
     </code>
     () function. Destroying
      a thread attributes object has no effect on threads that were
      created using that object.
    </p>
    <p>
     Once a thread attributes object has been destroyed, it can
      be reinitialized using
     <code class="function">
      pthread_attr_init
     </code>
     (). Any other use of a
      destroyed thread attributes object has undefined results.
    </p>
   </div>
   <div class="refsect1">
    <a id="pthread-attr-init-3_sect2" name="pthread-attr-init-3_sect2" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     On success, these functions return 0; on error, they
      return a nonzero error number.
    </p>
   </div>
   <div class="refsect1">
    <a id="pthread-attr-init-3_sect3" name="pthread-attr-init-3_sect3" shape="rect">
    </a>
    <h2>
     ERRORS
    </h2>
    <p>
     POSIX.1-2001 documents an
     <span class="errorname">
      ENOMEM
     </span>
     error for
     <code class="function">
      pthread_attr_init
     </code>
     (); on Linux these
      functions always succeed (but portable and future-proof
      applications should nevertheless handle a possible error
      return).
    </p>
   </div>
   <div class="refsect1">
    <a id="pthread-attr-init-3_sect4" name="pthread-attr-init-3_sect4" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     POSIX.1-2001.
    </p>
   </div>
   <div class="refsect1">
    <a id="pthread-attr-init-3_sect5" name="pthread-attr-init-3_sect5" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     The
     <span class="type">
      pthread_attr_t
     </span>
     type should
      be treated as opaque: any access to the object other than via
      pthreads functions is nonportable and produces undefined
      results.
    </p>
   </div>
   <div class="refsect1">
    <a id="pthread-attr-init-3_sect6" name="pthread-attr-init-3_sect6" shape="rect">
    </a>
    <h2>
     EXAMPLE
    </h2>
    <p>
     The program below optionally makes use of
     <code class="function">
      pthread_attr_init
     </code>
     () and various related
      functions to initialize a thread attributes object that is
      used to create a single thread. Once created, the thread uses
      the
     <a class="link" href="../htmlman3/pthread_getattr_np.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_getattr_np
       </span>
       (3)
      </span>
     </a>
     function (a nonstandard GNU extension) to retrieve the
      thread's attributes, and then displays those attributes.
    </p>
    <p>
     If the program is run with no command-line argument, then
      it passes NULL as the
     <em class="parameter">
      <code>
       attr
      </code>
     </em>
     argument of
     <a class="link" href="../htmlman3/pthread_create.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_create
       </span>
       (3)
      </span>
     </a>
     , so that
      the thread is created with default attributes. Running the
      program on Linux/x86-32 with the NPTL threading
      implementation, we see the following:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$<span class="emphasis"><em> ulimit &minus;s</em></span>       # No stack imit ==&gt; default stack size is 2MB
unlimited
$<span class="emphasis"><em> ./a.out</em></span>
Thread attributes:
        Detach state        = PTHREAD_CREATE_JOINABLE
        Scope               = PTHREAD_SCOPE_SYSTEM
        Inherit scheduler   = PTHREAD_INHERIT_SCHED
        Scheduling policy   = SCHED_OTHER
        Scheduling priority = 0
        Guard size          = 4096 bytes
        Stack address       = 0x40196000
        Stack size          = 0x201000 bytes
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     When we supply a stack size as a command-line argument,
      the program initializes a thread attributes object, sets
      various attributes in that object, and passes a pointer to
      the object in the call to
     <a class="link" href="../htmlman3/pthread_create.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_create
       </span>
       (3)
      </span>
     </a>
     . Running
      the program on Linux/x86-32 with the NPTL threading
      implementation, we see the following:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$<span class="emphasis"><em> ./a.out 0x3000000</em></span>
posix_memalign() allocated at 0x40197000
Thread attributes:
        Detach state        = PTHREAD_CREATE_DETACHED
        Scope               = PTHREAD_SCOPE_SYSTEM
        Inherit scheduler   = PTHREAD_EXPLICIT_SCHED
        Scheduling policy   = SCHED_OTHER
        Scheduling priority = 0
        Guard size          = 0 bytes
        Stack address       = 0x40197000
        Stack size          = 0x3000000 bytes
</pre>
      </div>
     </blockquote>
    </div>
    <div class="refsect2">
     <a id="pthread-attr-init-3_sect7" name="pthread-attr-init-3_sect7" shape="rect">
     </a>
     <h3>
      Program source
     </h3>
     <div class="informalexample">
      <pre class="programlisting" xml:space="preserve">
#define _GNU_SOURCE     /* To get pthread_getattr_np() declaration */
#include &lt;pthread.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;errno.h&gt;

#define handle_error_en(en, msg) \
        do { errno = en; perror(msg); exit(EXIT_FAILURE); } while (0)

static void
display_pthread_attr(pthread_attr_t *attr, char *prefix)
{
    int s, i;
    size_t v;
    void *stkaddr;
    struct sched_param sp;

    s = pthread_attr_getdetachstate(attr, &amp;i);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getdetachstate");
    printf("%sDetach state        = %s\n", prefix,
            (i == PTHREAD_CREATE_DETACHED) ? "PTHREAD_CREATE_DETACHED" :
            (i == PTHREAD_CREATE_JOINABLE) ? "PTHREAD_CREATE_JOINABLE" :
            "???");

    s = pthread_attr_getscope(attr, &amp;i);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getscope");
    printf("%sScope               = %s\n", prefix,
            (i == PTHREAD_SCOPE_SYSTEM)  ? "PTHREAD_SCOPE_SYSTEM" :
            (i == PTHREAD_SCOPE_PROCESS) ? "PTHREAD_SCOPE_PROCESS" :
            "???");

    s = pthread_attr_getinheritsched(attr, &amp;i);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getinheritsched");
    printf("%sInherit scheduler   = %s\n", prefix,
            (i == PTHREAD_INHERIT_SCHED)  ? "PTHREAD_INHERIT_SCHED" :
            (i == PTHREAD_EXPLICIT_SCHED) ? "PTHREAD_EXPLICIT_SCHED" :
            "???");

    s = pthread_attr_getschedpolicy(attr, &amp;i);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getschedpolicy");
    printf("%sScheduling policy   = %s\n", prefix,
            (i == SCHED_OTHER) ? "SCHED_OTHER" :
            (i == SCHED_FIFO)  ? "SCHED_FIFO" :
            (i == SCHED_RR)    ? "SCHED_RR" :
            "???");

    s = pthread_attr_getschedparam(attr, &amp;sp);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getschedparam");
    printf("%sScheduling priority = %d\n", prefix, sp.sched_priority);

    s = pthread_attr_getguardsize(attr, &amp;v);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getguardsize");
    printf("%sGuard size          = %d bytes\n", prefix, v);

    s = pthread_attr_getstack(attr, &amp;stkaddr, &amp;v);
    if (s != 0)
        handle_error_en(s, "pthread_attr_getstack");
    printf("%sStack address       = %p\n", prefix, stkaddr);
    printf("%sStack size          = 0x%x bytes\n", prefix, v);
}

static void *
thread_start(void *arg)
{
    int s;
    pthread_attr_t gattr;

    /* pthread_getattr_np() is a non&minus;standard GNU extension that
       retrieves the attributes of the thread specified in its
       first argument */

    s = pthread_getattr_np(pthread_self(), &amp;gattr);
    if (s != 0)
        handle_error_en(s, "pthread_getattr_np");

    printf("Thread attributes:\n");
    display_pthread_attr(&amp;gattr, "\t");

    exit(EXIT_SUCCESS);         /* Terminate all threads */
}

int
main(int argc, char *argv[])
{
    pthread_t thr;
    pthread_attr_t attr;
    pthread_attr_t *attrp;      /* NULL or &amp;attr */
    int s;

    attrp = NULL;

    /* If a command&minus;line argument was supplied, use it to set the
       stack&minus;size attribute and set a few other thread attributes,
       and set attrp pointing to thread attributes object */

    if (argc &gt; 1) {
        int stack_size;
        void *sp;

        attrp = &amp;attr;

        s = pthread_attr_init(&amp;attr);
        if (s != 0)
            handle_error_en(s, "pthread_attr_init");

        s = pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_DETACHED);
        if (s != 0)
            handle_error_en(s, "pthread_attr_setdetachstate");

        s = pthread_attr_setinheritsched(&amp;attr, PTHREAD_EXPLICIT_SCHED);
        if (s != 0)
            handle_error_en(s, "pthread_attr_setinheritsched");

        stack_size = strtoul(argv[1], NULL, 0);

        s = posix_memalign(&amp;sp, sysconf(_SC_PAGESIZE), stack_size);
        if (s != 0)
            handle_error_en(s, "posix_memalign");

        printf("posix_memalign() allocated at %p\n", sp);

        s = pthread_attr_setstack(&amp;attr, sp, stack_size);
        if (s != 0)
            handle_error_en(s, "pthread_attr_setstack");
    }

    s = pthread_create(&amp;thr, attrp, &amp;thread_start, NULL);
    if (s != 0)
        handle_error_en(s, "pthread_create");

    if (attrp != NULL) {
        s = pthread_attr_destroy(attrp);
        if (s != 0)
            handle_error_en(s, "pthread_attr_destroy");
    }

    pause();    /* Terminates when other thread calls exit() */
}
</pre>
     </div>
    </div>
   </div>
   <div class="refsect1">
    <a id="pthread-attr-init-3_sect8" name="pthread-attr-init-3_sect8" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman3/pthread_attr_setaffinity_np.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setaffinity_np
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_attr_setdetachstate.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setdetachstate
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_attr_setguardsize.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setguardsize
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_attr_setinheritsched.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setinheritsched
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_attr_setschedparam.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setschedparam
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_attr_setschedpolicy.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setschedpolicy
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_attr_setscope.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setscope
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_attr_setstack.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setstack
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_attr_setstackaddr.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setstackaddr
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_attr_setstacksize.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_setstacksize
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_create.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_create
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_getattr_np.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_getattr_np
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/pthreads.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthreads
       </span>
       (7)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="pthread-attr-init-3_sect9" name="pthread-attr-init-3_sect9" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
