<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   rcmd(3) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="rcmd(3) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="rcmd.3" name="rcmd.3" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     rcmd, rresvport, iruserok, ruserok, rcmd_af, rresvport_af,
      iruserok_af, ruserok_af &mdash; routines for returning a
      stream to a remote command
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="funcsynopsis">
     <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;netdb.h&gt;   /* Or &lt;unistd.h&gt; on some systems */
</pre>
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          rcmd
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        char **
        <var class="pdparam">
         ahost
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        unsigned short
        <var class="pdparam">
         inport
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         locuser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         remuser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         cmd
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int *
        <var class="pdparam">
         fd2p
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          rresvport
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        int *
        <var class="pdparam">
         port
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          iruserok
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        uint32_t
        <var class="pdparam">
         raddr
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         superuser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         ruser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         luser
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          ruserok
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         rhost
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         superuser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         ruser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         luser
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          rcmd_af
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        char **
        <var class="pdparam">
         ahost
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        unsigned short
        <var class="pdparam">
         inport
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         locuser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         remuser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         cmd
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int *
        <var class="pdparam">
         fd2p
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        sa_family_t
        <var class="pdparam">
         af
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          rresvport_af
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        int *
        <var class="pdparam">
         port
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        sa_family_t
        <var class="pdparam">
         af
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          iruserok_af
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        const void *
        <var class="pdparam">
         raddr
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         superuser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         ruser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         luser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        sa_family_t
        <var class="pdparam">
         af
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          ruserok_af
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         rhost
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         superuser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         ruser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const char *
        <var class="pdparam">
         luser
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        sa_family_t
        <var class="pdparam">
         af
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
     <table border="0" summary="Note">
      <tr>
       <td align="center" colspan="1" rowspan="2" valign="top" width="25">
        <img alt="[Note]" src="../stylesheet/note.png"/>
       </td>
       <th align="left" colspan="1" rowspan="1">
        Note
       </th>
      </tr>
      <tr>
       <td align="left" colspan="1" rowspan="1" valign="top">
        <div class="featuretests">
         <table style="border-collapse: collapse;">
          <colgroup span="1">
           <col span="1">
           </col>
          </colgroup>
          <thead>
           <tr>
            <th colspan="1" rowspan="1" style="">
             Feature Test Macro Requirements
                      for glibc (see
             <a class="link" href="../htmlman7/feature_test_macros.7.html" shape="rect" target="_top">
              <span class="citerefentry">
               <span class="refentrytitle">
                feature_test_macros
               </span>
               (7)
              </span>
             </a>
             ):
            </th>
           </tr>
          </thead>
          <tbody>
           <tr>
            <td colspan="1" rowspan="1" style="">
             <code class="function">
              rcmd
             </code>
             (),
             <code class="function">
              rcmd_af
             </code>
             (),
             <code class="function">
              rresvport
             </code>
             (),
             <code class="function">
              rresvport_af
             </code>
             (),
             <code class="function">
              iruserok
             </code>
             (),
             <code class="function">
              iruserok_af
             </code>
             (),
             <code class="function">
              ruserok
             </code>
             (),
             <code class="function">
              ruserok_af
             </code>
             ():
            </td>
           </tr>
           <tr>
            <td class="featuretestdef" colspan="1" rowspan="1" style="">
             <code class="constant">
              _BSD_SOURCE
             </code>
            </td>
           </tr>
          </tbody>
         </table>
        </div>
       </td>
      </tr>
     </table>
    </div>
   </div>
   <div class="refsect1">
    <a id="rcmd-3_sect1" name="rcmd-3_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     The
     <code class="function">
      rcmd
     </code>
     () function is used
      by the superuser to execute a command on a remote machine
      using an authentication scheme based on privileged port
      numbers. The
     <code class="function">
      rresvport
     </code>
     ()
      function returns a descriptor to a socket with an address in
      the privileged port space. The
     <code class="function">
      iruserok
     </code>
     () and
     <code class="function">
      ruserok
     </code>
     () functions are used by servers to
      authenticate clients requesting service with
     <code class="function">
      rcmd
     </code>
     (). All four functions are used by the
     <span class="citerefentry">
      <span class="refentrytitle">
       rshd
      </span>
      (8)
     </span>
     server (among
      others).
    </p>
    <div class="refsect2">
     <a id="rcmd-3_sect2" name="rcmd-3_sect2" shape="rect">
     </a>
     <h3>
      rcmd()
     </h3>
     <p>
      The
      <code class="function">
       rcmd
      </code>
      () function looks
        up the host *
      <em class="parameter">
       <code>
        ahost
       </code>
      </em>
      using
      <a class="link" href="../htmlman3/gethostbyname.3.html" shape="rect" target="_top">
       <span class="citerefentry">
        <span class="refentrytitle">
         gethostbyname
        </span>
        (3)
       </span>
      </a>
      ,
        returning &minus;1 if the host does not exist. Otherwise,
        *
      <em class="parameter">
       <code>
        ahost
       </code>
      </em>
      is set to
        the standard name of the host and a connection is
        established to a server residing at the well-known Internet
        port
      <em class="parameter">
       <code>
        inport
       </code>
      </em>
      .
     </p>
     <p>
      If the connection succeeds, a socket in the Internet
        domain of type
      <code class="constant">
       SOCK_STREAM
      </code>
      is
        returned to the caller, and given to the remote command as
      <code class="varname">
       stdin
      </code>
      and
      <code class="varname">
       stdout
      </code>
      . If
      <em class="parameter">
       <code>
        fd2p
       </code>
      </em>
      is nonzero, then an
        auxiliary channel to a control process will be set up, and
        a descriptor for it will be placed in *
      <em class="parameter">
       <code>
        fd2p
       </code>
      </em>
      . The control process
        will return diagnostic output from the command (unit 2) on
        this channel, and will also accept bytes on this channel as
        being UNIX signal numbers, to be forwarded to the process
        group of the command. If
      <em class="parameter">
       <code>
        fd2p
       </code>
      </em>
      is 0, then the
      <code class="varname">
       stderr
      </code>
      (unit 2 of the remote
        command) will be made the same as the
      <code class="varname">
       stdout
      </code>
      and no provision is made for
        sending arbitrary signals to the remote process, although
        you may be able to get its attention by using out-of-band
        data.
     </p>
     <p>
      The protocol is described in detail in
      <span class="citerefentry">
       <span class="refentrytitle">
        rshd
       </span>
       (8)
      </span>
      .
     </p>
    </div>
    <div class="refsect2">
     <a id="rcmd-3_sect3" name="rcmd-3_sect3" shape="rect">
     </a>
     <h3>
      rresvport()
     </h3>
     <p>
      The
      <code class="function">
       rresvport
      </code>
      () function
        is used to obtain a socket with a privileged port bound to
        it. This socket is suitable for use by
      <code class="function">
       rcmd
      </code>
      () and several other functions.
        Privileged ports are those in the range 0 to 1023. Only a
        privileged process (
      <code class="constant">
       CAP_NET_BIND_SERVICE
      </code>
      ) is allowed to bind
        to a privileged port. In the glibc implementation, this
        function restricts its search to the ports from 512 to
        1023. The
      <em class="parameter">
       <code>
        port
       </code>
      </em>
      argument is value-result: the value it supplies to the call
        is used as the starting point for a circular search of the
        port range; on (successful) return, it contains the port
        number that was bound to.
     </p>
    </div>
    <div class="refsect2">
     <a id="rcmd-3_sect4" name="rcmd-3_sect4" shape="rect">
     </a>
     <h3>
      iruserok() and ruserok()
     </h3>
     <p>
      The
      <code class="function">
       iruserok
      </code>
      () and
      <code class="function">
       ruserok
      </code>
      () functions take a
        remote host's IP address or name, respectively, two
        usernames and a flag indicating whether the local user's
        name is that of the superuser. Then, if the user is
      <span class="emphasis">
       <em>
        not
       </em>
      </span>
      the superuser,
        it checks the
      <code class="filename">
       /etc/hosts.equiv
      </code>
      file. If that lookup is
        not done, or is unsuccessful, the
      <em class="replaceable">
       <code>
        .rhosts
       </code>
      </em>
      in the local user's
        home directory is checked to see if the request for service
        is allowed.
     </p>
     <p>
      If this file does not exist, is not a regular file, is
        owned by anyone other than the user or the superuser, or is
        writable by anyone other than the owner, the check
        automatically fails. Zero is returned if the machine name
        is listed in the
      <em class="replaceable">
       <code>
        hosts.equiv
       </code>
      </em>
      file, or the
        host and remote username are found in the
      <em class="replaceable">
       <code>
        .rhosts
       </code>
      </em>
      file; otherwise
      <code class="function">
       iruserok
      </code>
      () and
      <code class="function">
       ruserok
      </code>
      () return &minus;1. If the local
        domain (as obtained from
      <a class="link" href="../htmlman2/gethostname.2.html" shape="rect" target="_top">
       <span class="citerefentry">
        <span class="refentrytitle">
         gethostname
        </span>
        (2)
       </span>
      </a>
      ) is the
        same as the remote domain, only the machine name need be
        specified.
     </p>
     <p>
      If the IP address of the remote host is known,
      <code class="function">
       iruserok
      </code>
      () should be used in
        preference to
      <code class="function">
       ruserok
      </code>
      (), as
        it does not require trusting the DNS server for the remote
        host's domain.
     </p>
    </div>
    <div class="refsect2">
     <a id="rcmd-3_sect5" name="rcmd-3_sect5" shape="rect">
     </a>
     <h3>
      *_af() variants
     </h3>
     <p>
      All of the functions described above work with IPv4
        (
      <code class="constant">
       AF_INET
      </code>
      ) sockets. The "_af"
        variants take an extra argument that allows the socket
        address family to be specified. For these functions, the
      <em class="parameter">
       <code>
        af
       </code>
      </em>
      argument can be
        specified as
      <code class="constant">
       AF_INET
      </code>
      or
      <code class="constant">
       AF_INET6
      </code>
      . In addition,
      <code class="function">
       rcmd_af
      </code>
      () supports the use of
      <code class="constant">
       AF_UNSPEC
      </code>
      .
     </p>
    </div>
   </div>
   <div class="refsect1">
    <a id="rcmd-3_sect6" name="rcmd-3_sect6" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     The
     <code class="function">
      rcmd
     </code>
     () function returns
      a valid socket descriptor on success. It returns &minus;1 on
      error and prints a diagnostic message on the standard
      error.
    </p>
    <p>
     The
     <code class="function">
      rresvport
     </code>
     () function
      returns a valid, bound socket descriptor on success. It
      returns &minus;1 on error with the global value
     <code class="varname">
      errno
     </code>
     set according to the reason for
      failure. The error code
     <span class="errorname">
      EAGAIN
     </span>
     is overloaded to mean "All network ports in use."
    </p>
    <p>
     For information on the return from
     <code class="function">
      ruserok
     </code>
     () and
     <code class="function">
      iruserok
     </code>
     (), see above.
    </p>
   </div>
   <div class="refsect1">
    <a id="rcmd-3_sect7" name="rcmd-3_sect7" shape="rect">
    </a>
    <h2>
     VERSIONS
    </h2>
    <p>
     The functions
     <code class="function">
      iruserok_af
     </code>
     (),
     <code class="function">
      rcmd_af
     </code>
     (),
     <code class="function">
      rresvport_af
     </code>
     (), and
     <code class="function">
      ruserok_af
     </code>
     () functions are provide in glibc
      since version 2.2.
    </p>
   </div>
   <div class="refsect1">
    <a id="rcmd-3_sect8" name="rcmd-3_sect8" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     Not in POSIX.1-2001. Present on the BSDs, Solaris, and
      many other systems. These functions appeared in 4.2BSD. The
      "_af" variants are more recent additions, and are not present
      on as wide a range of systems.
    </p>
   </div>
   <div class="refsect1">
    <a id="rcmd-3_sect9" name="rcmd-3_sect9" shape="rect">
    </a>
    <h2>
     BUGS
    </h2>
    <p>
     <code class="function">
      iruserok
     </code>
     () and
     <code class="function">
      iruserok_af
     </code>
     () are declared in glibc headers
      only since version 2.12.
    </p>
   </div>
   <div class="refsect1">
    <a id="rcmd-3_sect10" name="rcmd-3_sect10" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <span class="citerefentry">
      <span class="refentrytitle">
       rlogin
      </span>
      (1)
     </span>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       rsh
      </span>
      (1)
     </span>
     ,
     <a class="link" href="../htmlman2/intro.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        intro
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/rexec.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        rexec
       </span>
       (3)
      </span>
     </a>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       rexecd
      </span>
      (8)
     </span>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       rlogind
      </span>
      (8)
     </span>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       rshd
      </span>
      (8)
     </span>
    </p>
   </div>
   <div class="colophon">
    <a id="rcmd-3_sect11" name="rcmd-3_sect11" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
