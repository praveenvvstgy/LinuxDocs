<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   tsearch(3) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="tsearch(3) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="tsearch.3" name="tsearch.3" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     tsearch, tfind, tdelete, twalk, tdestroy &mdash; manage a
      binary tree
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="funcsynopsis">
     <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;search.h&gt;
</pre>
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         void
            *
         <strong>
          tsearch
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        const void *
        <var class="pdparam">
         key
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        void **
        <var class="pdparam">
         rootp
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         (*compar)
        </var>
        <code>
         (
        </code>
        const void *,
            const void *
        <code>
         )
        </code>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         void
            *
         <strong>
          tfind
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        const void *
        <var class="pdparam">
         key
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        void *const *
        <var class="pdparam">
         rootp
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         (*compar)
        </var>
        <code>
         (
        </code>
        const void *,
            const void *
        <code>
         )
        </code>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         void
            *
         <strong>
          tdelete
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        const void *
        <var class="pdparam">
         key
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        void **
        <var class="pdparam">
         rootp
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         (*compar)
        </var>
        <code>
         (
        </code>
        const void *,
            const void *
        <code>
         )
        </code>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         void
         <strong>
          twalk
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        const void *
        <var class="pdparam">
         root
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        void
        <var class="pdparam">
         (*action)
        </var>
        <code>
         (
        </code>
        const void
            *nodep, const VISIT which, const int
            depth
        <code>
         )
        </code>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">

#define _GNU_SOURCE          /* See feature_test_macros(7) */
#include &lt;search.h&gt;
</pre>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         void
         <strong>
          tdestroy
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        void *
        <var class="pdparam">
         root
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        void
        <var class="pdparam">
         (*free_node)
        </var>
        <code>
         (
        </code>
        void
            *nodep
        <code>
         )
        </code>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
   </div>
   <div class="refsect1">
    <a id="tsearch-3_sect1" name="tsearch-3_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     <code class="function">
      tsearch
     </code>
     (),
     <code class="function">
      tfind
     </code>
     (),
     <code class="function">
      twalk
     </code>
     (), and
     <code class="function">
      tdelete
     </code>
     () manage a binary tree. They are
      generalized from Knuth (6.2.2) Algorithm T. The first field
      in each node of the tree is a pointer to the corresponding
      data item. (The calling program must store the actual data.)
     <em class="parameter">
      <code>
       compar
      </code>
     </em>
     points to a
      comparison routine, which takes pointers to two items. It
      should return an integer which is negative, zero, or
      positive, depending on whether the first item is less than,
      equal to, or greater than the second.
    </p>
    <p>
     <code class="function">
      tsearch
     </code>
     () searches the tree
      for an item.
     <em class="parameter">
      <code>
       key
      </code>
     </em>
     points to the item to be searched for.
     <em class="parameter">
      <code>
       rootp
      </code>
     </em>
     points to a variable
      which points to the root of the tree. If the tree is empty,
      then the variable that
     <em class="parameter">
      <code>
       rootp
      </code>
     </em>
     points to should be set
      to NULL. If the item is found in the tree, then
     <code class="function">
      tsearch
     </code>
     () returns a pointer to it. If it is
      not found, then
     <code class="function">
      tsearch
     </code>
     () adds
      it, and returns a pointer to the newly added item.
    </p>
    <p>
     <code class="function">
      tfind
     </code>
     () is like
     <code class="function">
      tsearch
     </code>
     (), except that if the item is not
      found, then
     <code class="function">
      tfind
     </code>
     () returns
      NULL.
    </p>
    <p>
     <code class="function">
      tdelete
     </code>
     () deletes an item
      from the tree. Its arguments are the same as for
     <code class="function">
      tsearch
     </code>
     ().
    </p>
    <p>
     <code class="function">
      twalk
     </code>
     () performs
      depth-first, left-to-right traversal of a binary tree.
     <em class="parameter">
      <code>
       root
      </code>
     </em>
     points to the
      starting node for the traversal. If that node is not the
      root, then only part of the tree will be visited.
     <code class="function">
      twalk
     </code>
     () calls the user function
     <em class="parameter">
      <code>
       action
      </code>
     </em>
     each time a
      node is visited (that is, three times for an internal node,
      and once for a leaf).
     <em class="parameter">
      <code>
       action
      </code>
     </em>
     , in turn, takes three
      arguments. The first argument is a pointer to the node being
      visited. The structure of the node is unspecified, but it is
      possible to cast the pointer to a
      pointer-to-pointer-to-element in order to access the element
      stored within the node. The application must not modify the
      structure pointed to by this argument. The second argument is
      an integer which takes one of the values
     <code class="literal">
      preorder
     </code>
     ,
     <code class="literal">
      postorder
     </code>
     , or
     <code class="literal">
      endorder
     </code>
     depending on whether this is the
      first, second, or third visit to the internal node, or the
      value
     <code class="literal">
      leaf
     </code>
     if this is the single
      visit to a leaf node. (These symbols are defined in
     <code class="literal">
      &lt;
     </code>
     <code class="filename">
      search.h
     </code>
     <code class="literal">
      &gt;
     </code>
     The third argument is the depth of the node; the root node
      has depth zero.
    </p>
    <p>
     (More commonly,
     <code class="literal">
      preorder
     </code>
     ,
     <code class="literal">
      postorder
     </code>
     , and
     <code class="literal">
      endorder
     </code>
     are known as
     <code class="literal">
      preorder
     </code>
     ,
     <code class="literal">
      inorder
     </code>
     , and
     <code class="literal">
      postorder
     </code>
     : before visiting the children,
      after the first and before the second, and after visiting the
      children. Thus, the choice of name
     <code class="literal">
      postorder
     </code>
     is rather confusing.)
    </p>
    <p>
     <code class="function">
      tdestroy
     </code>
     () removes the whole
      tree pointed to by
     <em class="parameter">
      <code>
       root
      </code>
     </em>
     , freeing all resources
      allocated by the
     <code class="function">
      tsearch
     </code>
     ()
      function. For the data in each tree node the function
     <em class="parameter">
      <code>
       free_node
      </code>
     </em>
     is called.
      The pointer to the data is passed as the argument to the
      function. If no such work is necessary,
     <em class="parameter">
      <code>
       free_node
      </code>
     </em>
     must point to a
      function doing nothing.
    </p>
   </div>
   <div class="refsect1">
    <a id="tsearch-3_sect2" name="tsearch-3_sect2" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     <code class="function">
      tsearch
     </code>
     () returns a pointer
      to a matching item in the tree, or to the newly added item,
      or NULL if there was insufficient memory to add the item.
     <code class="function">
      tfind
     </code>
     () returns a pointer to
      the item, or NULL if no match is found. If there are multiple
      elements that match the key, the element returned is
      unspecified.
    </p>
    <p>
     <code class="function">
      tdelete
     </code>
     () returns a pointer
      to the parent of the item deleted, or NULL if the item was
      not found.
    </p>
    <p>
     <code class="function">
      tsearch
     </code>
     (),
     <code class="function">
      tfind
     </code>
     (), and
     <code class="function">
      tdelete
     </code>
     () also return NULL if
     <em class="parameter">
      <code>
       rootp
      </code>
     </em>
     was NULL on entry.
    </p>
   </div>
   <div class="refsect1">
    <a id="tsearch-3_sect3" name="tsearch-3_sect3" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     SVr4, POSIX.1-2001. The function
     <code class="function">
      tdestroy
     </code>
     () is a GNU extension.
    </p>
   </div>
   <div class="refsect1">
    <a id="tsearch-3_sect4" name="tsearch-3_sect4" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     <code class="function">
      twalk
     </code>
     () takes a pointer to
      the root, while the other functions take a pointer to a
      variable which points to the root.
    </p>
    <p>
     <code class="function">
      tdelete
     </code>
     () frees the memory
      required for the node in the tree. The user is responsible
      for freeing the memory for the corresponding data.
    </p>
    <p>
     The example program depends on the fact that
     <code class="function">
      twalk
     </code>
     () makes no further reference to a
      node after calling the user function with argument "endorder"
      or "leaf". This works with the GNU library implementation,
      but is not in the System V documentation.
    </p>
   </div>
   <div class="refsect1">
    <a id="tsearch-3_sect5" name="tsearch-3_sect5" shape="rect">
    </a>
    <h2>
     EXAMPLE
    </h2>
    <p>
     The following program inserts twelve random numbers into a
      binary tree, where duplicate numbers are collapsed, then
      prints the numbers in order.
    </p>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
#define _GNU_SOURCE     /* Expose declaration of tdestroy() */
#include &lt;search.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

static void *root = NULL;

static void *
xmalloc(unsigned n)
{
    void *p;
    p = malloc(n);
    if (p)
        return p;
    fprintf(stderr, "insufficient memory\n");
    exit(EXIT_FAILURE);
}

static int
compare(const void *pa, const void *pb)
{
    if (*(int *) pa &lt; *(int *) pb)
        return &minus;1;
    if (*(int *) pa &gt; *(int *) pb)
        return 1;
    return 0;
}

static void
action(const void *nodep, const VISIT which, const int depth)
{
    int *datap;

    switch (which) {
    case preorder:
        break;
    case postorder:
        datap = *(int **) nodep;
        printf("%6d\n", *datap);
        break;
    case endorder:
        break;
    case leaf:
        datap = *(int **) nodep;
        printf("%6d\n", *datap);
        break;
    }
}

int
main(void)
{
    int i, *ptr;
    void *val;

    srand(time(NULL));
    for (i = 0; i &lt; 12; i++) {
        ptr = xmalloc(sizeof(int));
        *ptr = rand() &amp; 0xff;
        val = tsearch((void *) ptr, &amp;root, compare);
        if (val == NULL)
            exit(EXIT_FAILURE);
        else if ((*(int **) val) != ptr)
            free(ptr);
    }
    twalk(root, action);
    tdestroy(root, free);
    exit(EXIT_SUCCESS);
}
</pre>
    </div>
   </div>
   <div class="refsect1">
    <a id="tsearch-3_sect6" name="tsearch-3_sect6" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman3/bsearch.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        bsearch
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/hsearch.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        hsearch
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/lsearch.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        lsearch
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/qsort.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        qsort
       </span>
       (3)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="tsearch-3_sect7" name="tsearch-3_sect7" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
