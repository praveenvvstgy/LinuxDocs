<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   pam_acct_mgmt(3) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="pam_acct_mgmt(3) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry" title="pam_acct_mgmt(3) &mdash; Linux manual pages">
   <a id="pam-acct-mgmt.3" name="pam-acct-mgmt.3" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <a id="pam_acct_mgmt-name" name="pam_acct_mgmt-name" shape="rect">
    </a>
    <h2>
     Name
    </h2>
    <p>
     pam_acct_mgmt &mdash; PAM account validation
      management
    </p>
   </div>
   <div class="refsynopsisdiv" title="Synopsis">
    <h2>
     Synopsis
    </h2>
    <div class="funcsynopsis">
     <a id="pam_acct_mgmt-synopsis" name="pam_acct_mgmt-synopsis" shape="rect">
     </a>
     <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;security/pam_appl.h&gt;
</pre>
     <table border="0" cellpadding="0" cellspacing="0" class="funcprototype-table" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          pam_acct_mgmt
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        pam_handle_t *
        <var class="pdparam">
         pamh
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         flags
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
   </div>
   <div class="refsect1" title="DESCRIPTION">
    <a id="pam_acct_mgmt-description" name="pam_acct_mgmt-description" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     The
     <code class="function">
      pam_acct_mgmt
     </code>
     function
      is used to determine if the users account is valid. It checks
      for authentication token and account expiration and verifies
      access restrictions. It is typically called after the user
      has been authenticated.
    </p>
    <p>
     The
     <span class="emphasis">
      <em>
       pamh
      </em>
     </span>
     argument
      is an authentication handle obtained by a prior call to
      pam_start(). The flags argument is the binary or of zero or
      more of the following values:
    </p>
    <div class="variablelist">
     <dl>
      <dt>
       <span class="term">
        PAM_SILENT
       </span>
      </dt>
      <dd>
       <p>
        Do not emit any messages.
       </p>
      </dd>
      <dt>
       <span class="term">
        PAM_DISALLOW_NULL_AUTHTOK
       </span>
      </dt>
      <dd>
       <p>
        The PAM module service should return
            PAM_NEW_AUTHTOK_REQD if the user has a null
            authentication token.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1" title="RETURN VALUES">
    <a id="pam_acct_mgmt-return_values" name="pam_acct_mgmt-return_values" shape="rect">
    </a>
    <h2>
     RETURN VALUES
    </h2>
    <div class="variablelist">
     <dl>
      <dt>
       <span class="term">
        PAM_ACCT_EXPIRED
       </span>
      </dt>
      <dd>
       <p>
        User account has expired.
       </p>
      </dd>
      <dt>
       <span class="term">
        PAM_AUTH_ERR
       </span>
      </dt>
      <dd>
       <p>
        Authentication failure.
       </p>
      </dd>
      <dt>
       <span class="term">
        PAM_NEW_AUTHTOK_REQD
       </span>
      </dt>
      <dd>
       <p>
        The user account is valid but their authentication
            token is
        <span class="emphasis">
         <em>
          expired
         </em>
        </span>
        . The correct
            response to this return-value is to require that the
            user satisfies the
        <code class="function">
         pam_chauthtok()
        </code>
        function before
            obtaining service. It may not be possible for some
            applications to do this. In such cases, the user should
            be denied access until such time as they can update
            their password.
       </p>
      </dd>
      <dt>
       <span class="term">
        PAM_PERM_DENIED
       </span>
      </dt>
      <dd>
       <p>
        Permission denied.
       </p>
      </dd>
      <dt>
       <span class="term">
        PAM_SUCCESS
       </span>
      </dt>
      <dd>
       <p>
        The authentication token was successfully
            updated.
       </p>
      </dd>
      <dt>
       <span class="term">
        PAM_USER_UNKNOWN
       </span>
      </dt>
      <dd>
       <p>
        User unknown to password service.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1" title="SEE ALSO">
    <a id="pam_acct_mgmt-see_also" name="pam_acct_mgmt-see_also" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman3/pam_start.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pam_start
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pam_authenticate.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pam_authenticate
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pam_chauthtok.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pam_chauthtok
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pam_strerror.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pam_strerror
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman8/pam.8.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pam
       </span>
       (8)
      </span>
     </a>
    </p>
   </div>
  </div>
 </body>
</html>
