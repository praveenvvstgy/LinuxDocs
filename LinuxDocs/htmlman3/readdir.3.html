<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   readdir(3) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="readdir(3) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="readdir.3" name="readdir.3" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     readdir, readdir_r &mdash; read a directory
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="funcsynopsis">
     <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;dirent.h&gt;
</pre>
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         struct dirent
            *
         <strong>
          readdir
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        DIR *
        <var class="pdparam">
         dirp
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          readdir_r
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        DIR *
        <var class="pdparam">
         dirp
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        struct dirent *
        <var class="pdparam">
         entry
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        struct dirent **
        <var class="pdparam">
         result
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
     <table border="0" summary="Note">
      <tr>
       <td align="center" colspan="1" rowspan="2" valign="top" width="25">
        <img alt="[Note]" src="../stylesheet/note.png"/>
       </td>
       <th align="left" colspan="1" rowspan="1">
        Note
       </th>
      </tr>
      <tr>
       <td align="left" colspan="1" rowspan="1" valign="top">
        <div class="featuretests">
         <table style="border-collapse: collapse;">
          <colgroup span="1">
           <col span="1">
           </col>
          </colgroup>
          <thead>
           <tr>
            <th colspan="1" rowspan="1" style="">
             Feature Test Macro Requirements
                      for glibc (see
             <a class="link" href="../htmlman7/feature_test_macros.7.html" shape="rect" target="_top">
              <span class="citerefentry">
               <span class="refentrytitle">
                feature_test_macros
               </span>
               (7)
              </span>
             </a>
             ):
            </th>
           </tr>
          </thead>
          <tbody>
           <tr>
            <td colspan="1" rowspan="1" style="">
             <code class="function">
              readdir_r
             </code>
             ():
            </td>
           </tr>
           <tr>
            <td class="featuretestdef" colspan="1" rowspan="1" style="">
             <code class="constant">
              _POSIX_C_SOURCE
             </code>
             &gt;= 1 ||
             <code class="constant">
              _XOPEN_SOURCE
             </code>
             ||
             <code class="constant">
              _BSD_SOURCE
             </code>
             ||
             <code class="constant">
              _SVID_SOURCE
             </code>
             ||
             <code class="constant">
              _POSIX_SOURCE
             </code>
            </td>
           </tr>
          </tbody>
         </table>
        </div>
       </td>
      </tr>
     </table>
    </div>
   </div>
   <div class="refsect1">
    <a id="readdir-3_sect1" name="readdir-3_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     The
     <code class="function">
      readdir
     </code>
     () function
      returns a pointer to a
     <span class="structname">
      dirent
     </span>
     structure representing the next directory entry in the
      directory stream pointed to by
     <em class="parameter">
      <code>
       dirp
      </code>
     </em>
     . It returns NULL on
      reaching the end of the directory stream or if an error
      occurred.
    </p>
    <p>
     On Linux, the
     <span class="structname">
      dirent
     </span>
     structure is defined as follows:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="structdef">
       <table style="border-collapse: collapse;">
        <colgroup span="1">
         <col class="c1" span="1">
         </col>
         <col class="c2" span="1">
         </col>
         <col class="c3" span="1">
         </col>
         <col class="c4" span="1">
         </col>
         <col class="c5" span="1">
         </col>
        </colgroup>
        <tbody>
         <tr>
          <td align="left" class="structdefhdr" colspan="1" rowspan="1" style="">
           struct
          </td>
          <td align="left" class="structdefhdr" colspan="4" rowspan="1" style="">
           <span class="structname">
            dirent
           </span>
           &nbsp;{
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            ino_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             d_ino
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;inode&nbsp;number&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            off_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             d_off
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;not&nbsp;an&nbsp;offset;&nbsp;see&nbsp;NOTES&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            unsigned&nbsp;short
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             d_reclen
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;length&nbsp;of&nbsp;this&nbsp;record&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            unsigned&nbsp;char
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             d_type
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;type&nbsp;of&nbsp;file;&nbsp;not&nbsp;supported
            <br/>
            by&nbsp;all&nbsp;filesystem&nbsp;types&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            char
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             d_name
            </code>
           </em>
           [256];
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;filename&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
           };
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </blockquote>
    </div>
    <p>
     The only fields in the
     <span class="structname">
      dirent
     </span>
     structure that are mandated by
      POSIX.1 are:
     <em class="parameter">
      <code>
       d_name
      </code>
     </em>
     [], of unspecified size,
      with at most
     <code class="constant">
      NAME_MAX
     </code>
     characters preceding the terminating null byte ('\0'); and
      (as an XSI extension)
     <em class="parameter">
      <code>
       d_ino
      </code>
     </em>
     . The other fields are
      unstandardized, and not present on all systems; see NOTES
      below for some further details.
    </p>
    <p>
     The data returned by
     <code class="function">
      readdir
     </code>
     () may be overwritten by subsequent
      calls to
     <code class="function">
      readdir
     </code>
     () for the same
      directory stream.
    </p>
    <p>
     The
     <code class="function">
      readdir_r
     </code>
     () function is
      a reentrant version of
     <code class="function">
      readdir
     </code>
     (). It reads the next directory
      entry from the directory stream
     <em class="parameter">
      <code>
       dirp
      </code>
     </em>
     , and returns it in the
      caller-allocated buffer pointed to by
     <em class="parameter">
      <code>
       entry
      </code>
     </em>
     . (See NOTES for
      information on allocating this buffer.) A pointer to the
      returned item is placed in *
     <em class="parameter">
      <code>
       result
      </code>
     </em>
     ; if the end of the
      directory stream was encountered, then NULL is instead
      returned in *
     <em class="parameter">
      <code>
       result
      </code>
     </em>
     .
    </p>
   </div>
   <div class="refsect1">
    <a id="readdir-3_sect2" name="readdir-3_sect2" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     On success,
     <code class="function">
      readdir
     </code>
     ()
      returns a pointer to a
     <span class="structname">
      dirent
     </span>
     structure. (This structure may be statically allocated; do
      not attempt to
     <a class="link" href="../htmlman3/malloc.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        free
       </span>
       (3)
      </span>
     </a>
     it.) If the end of
      the directory stream is reached, NULL is returned and
     <code class="varname">
      errno
     </code>
     is not changed. If an
      error occurs, NULL is returned and
     <code class="varname">
      errno
     </code>
     is set appropriately.
    </p>
    <p>
     The
     <code class="function">
      readdir_r
     </code>
     () function
      returns 0 on success. On error, it returns a positive error
      number (listed under ERRORS). If the end of the directory
      stream is reached,
     <code class="function">
      readdir_r
     </code>
     ()
      returns 0, and returns NULL in *
     <em class="parameter">
      <code>
       result
      </code>
     </em>
     .
    </p>
   </div>
   <div class="refsect1">
    <a id="readdir-3_sect3" name="readdir-3_sect3" shape="rect">
    </a>
    <h2>
     ERRORS
    </h2>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <span class="errorname">
         EBADF
        </span>
       </span>
      </dt>
      <dd>
       <p>
        Invalid directory stream descriptor
        <em class="parameter">
         <code>
          dirp
         </code>
        </em>
        .
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1">
    <a id="readdir-3_sect4" name="readdir-3_sect4" shape="rect">
    </a>
    <h2>
     ATTRIBUTES
    </h2>
    <div class="refsect2">
     <a id="readdir-3_sect5" name="readdir-3_sect5" shape="rect">
     </a>
     <h3>
      Multithreading (see pthreads(7))
     </h3>
     <p>
      The
      <code class="function">
       readdir
      </code>
      () function is
        not thread-safe.
     </p>
     <p>
      The
      <code class="function">
       readdir_r
      </code>
      () function
        is thread-safe.
     </p>
    </div>
   </div>
   <div class="refsect1">
    <a id="readdir-3_sect6" name="readdir-3_sect6" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     SVr4, 4.3BSD, POSIX.1-2001.
    </p>
   </div>
   <div class="refsect1">
    <a id="readdir-3_sect7" name="readdir-3_sect7" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     Only the fields
     <em class="parameter">
      <code>
       d_name
      </code>
     </em>
     and
     <em class="parameter">
      <code>
       d_ino
      </code>
     </em>
     are specified in
      POSIX.1-2001. The remaining fields are available on many, but
      not all systems. Under glibc, programs can check for the
      availability of the fields not defined in POSIX.1 by testing
      whether the macros
     <code class="constant">
      _DIRENT_HAVE_D_NAMLEN
     </code>
     ,
     <code class="constant">
      _DIRENT_HAVE_D_RECLEN
     </code>
     ,
     <code class="constant">
      _DIRENT_HAVE_D_OFF
     </code>
     , or
     <code class="constant">
      _DIRENT_HAVE_D_TYPE
     </code>
     are defined.
    </p>
    <p>
     The value returned in
     <em class="parameter">
      <code>
       d_off
      </code>
     </em>
     is the same as would be
      returned by calling
     <a class="link" href="../htmlman3/telldir.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        telldir
       </span>
       (3)
      </span>
     </a>
     at the current
      position in the directory stream. Be aware that despite its
      type and name, the
     <em class="parameter">
      <code>
       d_off
      </code>
     </em>
     field is seldom any kind
      of directory offset on modern filesystems. Applications
      should treat this field as an opaque value, making no
      assumptions about its contents; see also
     <a class="link" href="../htmlman3/telldir.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        telldir
       </span>
       (3)
      </span>
     </a>
     .
    </p>
    <p>
     Other than Linux, the
     <em class="parameter">
      <code>
       d_type
      </code>
     </em>
     field is available
      mainly only on BSD systems. This field makes it possible to
      avoid the expense of calling
     <a class="link" href="../htmlman2/stat.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        lstat
       </span>
       (2)
      </span>
     </a>
     if further actions
      depend on the type of the file. If the
     <code class="constant">
      _BSD_SOURCE
     </code>
     feature test macro is defined,
      then glibc defines the following macro constants for the
      value returned in
     <em class="parameter">
      <code>
       d_type
      </code>
     </em>
     :
    </p>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <code class="constant">
         DT_BLK
        </code>
       </span>
      </dt>
      <dd>
       <p>
        This is a block device.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         DT_CHR
        </code>
       </span>
      </dt>
      <dd>
       <p>
        This is a character device.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         DT_DIR
        </code>
       </span>
      </dt>
      <dd>
       <p>
        This is a directory.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         DT_FIFO
        </code>
       </span>
      </dt>
      <dd>
       <p>
        This is a named pipe (FIFO).
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         DT_LNK
        </code>
       </span>
      </dt>
      <dd>
       <p>
        This is a symbolic link.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         DT_REG
        </code>
       </span>
      </dt>
      <dd>
       <p>
        This is a regular file.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         DT_SOCK
        </code>
       </span>
      </dt>
      <dd>
       <p>
        This is a UNIX domain socket.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         DT_UNKNOWN
        </code>
       </span>
      </dt>
      <dd>
       <p>
        The file type is unknown.
       </p>
      </dd>
     </dl>
    </div>
    <p>
     If the file type could not be determined, the value
     <code class="constant">
      DT_UNKNOWN
     </code>
     is returned in
     <em class="parameter">
      <code>
       d_type
      </code>
     </em>
     .
    </p>
    <p>
     Currently, only some filesystems (among them: Btrfs, ext2,
      ext3, and ext4) have full support for returning the file type
      in
     <em class="parameter">
      <code>
       d_type
      </code>
     </em>
     . All
      applications must properly handle a return of
     <code class="constant">
      DT_UNKNOWN
     </code>
     .
    </p>
    <p>
     Since POSIX.1 does not specify the size of the
     <em class="parameter">
      <code>
       d_name
      </code>
     </em>
     field, and other
      nonstandard fields may precede that field within the
     <span class="structname">
      dirent
     </span>
     structure, portable
      applications that use
     <code class="function">
      readdir_r
     </code>
     () should allocate the buffer
      whose address is passed in
     <em class="parameter">
      <code>
       entry
      </code>
     </em>
     as follows:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
name_max = pathconf(dirpath, _PC_NAME_MAX);
if (name_max == &minus;1)         /* Limit not defined, or error */
    name_max = 255;         /* Take a guess */
len = offsetof(struct dirent, d_name) + name_max + 1;
entryp = malloc(len);
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     (POSIX.1 requires that
     <em class="parameter">
      <code>
       d_name
      </code>
     </em>
     is the last field in a
     <span class="emphasis">
      <em>
       struct dirent
      </em>
     </span>
     .)
    </p>
   </div>
   <div class="refsect1">
    <a id="readdir-3_sect8" name="readdir-3_sect8" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman2/getdents.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        getdents
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/read.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        read
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/closedir.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        closedir
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/dirfd.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        dirfd
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/ftw.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        ftw
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/offsetof.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        offsetof
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/opendir.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        opendir
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/rewinddir.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        rewinddir
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/scandir.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        scandir
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/seekdir.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        seekdir
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/telldir.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        telldir
       </span>
       (3)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="readdir-3_sect9" name="readdir-3_sect9" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
