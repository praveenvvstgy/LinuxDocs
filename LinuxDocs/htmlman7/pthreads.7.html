<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   pthreads(7) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="pthreads(7) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="pthreads.7" name="pthreads.7" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     pthreads &mdash; POSIX threads
    </p>
   </div>
   <div class="refsect1">
    <a id="pthreads-7_sect1" name="pthreads-7_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     POSIX.1 specifies a set of interfaces (functions, header
      files) for threaded programming commonly known as POSIX
      threads, or Pthreads. A single process can contain multiple
      threads, all of which are executing the same program. These
      threads share the same global memory (data and heap
      segments), but each thread has its own stack (automatic
      variables).
    </p>
    <p>
     POSIX.1 also requires that threads share a range of other
      attributes (i.e., these attributes are process-wide rather
      than per-thread):
    </p>
    <div class="itemizedlist">
     <ul class="itemizedlist" style="list-style-type: disc;">
      <li class="listitem">
       <p>
        process ID
       </p>
      </li>
      <li class="listitem">
       <p>
        parent process ID
       </p>
      </li>
      <li class="listitem">
       <p>
        process group ID and session ID
       </p>
      </li>
      <li class="listitem">
       <p>
        controlling terminal
       </p>
      </li>
      <li class="listitem">
       <p>
        user and group IDs
       </p>
      </li>
      <li class="listitem">
       <p>
        open file descriptors
       </p>
      </li>
      <li class="listitem">
       <p>
        record locks (see
        <a class="link" href="../htmlman2/fcntl.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           fcntl
          </span>
          (2)
         </span>
        </a>
        )
       </p>
      </li>
      <li class="listitem">
       <p>
        signal dispositions
       </p>
      </li>
      <li class="listitem">
       <p>
        file mode creation mask (
        <a class="link" href="../htmlman2/umask.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           umask
          </span>
          (2)
         </span>
        </a>
        )
       </p>
      </li>
      <li class="listitem">
       <p>
        current directory (
        <a class="link" href="../htmlman2/chdir.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           chdir
          </span>
          (2)
         </span>
        </a>
        ) and root
            directory (
        <a class="link" href="../htmlman2/chroot.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           chroot
          </span>
          (2)
         </span>
        </a>
        )
       </p>
      </li>
      <li class="listitem">
       <p>
        interval timers (
        <a class="link" href="../htmlman2/getitimer.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           setitimer
          </span>
          (2)
         </span>
        </a>
        ) and
            POSIX timers (
        <a class="link" href="../htmlman2/timer_create.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           timer_create
          </span>
          (2)
         </span>
        </a>
        )
       </p>
      </li>
      <li class="listitem">
       <p>
        nice value (
        <a class="link" href="../htmlman2/getpriority.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           setpriority
          </span>
          (2)
         </span>
        </a>
        )
       </p>
      </li>
      <li class="listitem">
       <p>
        resource limits (
        <a class="link" href="../htmlman2/getrlimit.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           setrlimit
          </span>
          (2)
         </span>
        </a>
        )
       </p>
      </li>
      <li class="listitem">
       <p>
        measurements of the consumption of CPU time
            (
        <a class="link" href="../htmlman2/times.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           times
          </span>
          (2)
         </span>
        </a>
        ) and
            resources (
        <a class="link" href="../htmlman2/getrusage.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           getrusage
          </span>
          (2)
         </span>
        </a>
        )
       </p>
      </li>
     </ul>
    </div>
    <p>
     As well as the stack, POSIX.1 specifies that various other
      attributes are distinct for each thread, including:
    </p>
    <div class="itemizedlist">
     <ul class="itemizedlist" style="list-style-type: disc;">
      <li class="listitem">
       <p>
        thread ID (the
        <em class="replaceable">
         <code>
          pthread_t
         </code>
        </em>
        data
            type)
       </p>
      </li>
      <li class="listitem">
       <p>
        signal mask (
        <a class="link" href="../htmlman3/pthread_sigmask.3.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           pthread_sigmask
          </span>
          (3)
         </span>
        </a>
        )
       </p>
      </li>
      <li class="listitem">
       <p>
        the
        <code class="varname">
         errno
        </code>
        variable
       </p>
      </li>
      <li class="listitem">
       <p>
        alternate signal stack (
        <a class="link" href="../htmlman2/sigaltstack.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           sigaltstack
          </span>
          (2)
         </span>
        </a>
        )
       </p>
      </li>
      <li class="listitem">
       <p>
        real-time scheduling policy and priority (
        <a class="link" href="../htmlman7/sched.7.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           sched
          </span>
          (7)
         </span>
        </a>
        )
       </p>
      </li>
     </ul>
    </div>
    <p>
     The following Linux-specific features are also
      per-thread:
    </p>
    <div class="itemizedlist">
     <ul class="itemizedlist" style="list-style-type: disc;">
      <li class="listitem">
       <p>
        capabilities (see
        <a class="link" href="../htmlman7/capabilities.7.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           capabilities
          </span>
          (7)
         </span>
        </a>
        )
       </p>
      </li>
      <li class="listitem">
       <p>
        CPU affinity (
        <a class="link" href="../htmlman2/sched_setaffinity.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           sched_setaffinity
          </span>
          (2)
         </span>
        </a>
        )
       </p>
      </li>
     </ul>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect2" name="pthreads-7_sect2" shape="rect">
     </a>
     <h3>
      Pthreads function return values
     </h3>
     <p>
      Most pthreads functions return 0 on success, and an
        error number of failure. Note that the pthreads functions
        do not set
      <code class="varname">
       errno
      </code>
      . For each of
        the pthreads functions that can return an error,
        POSIX.1-2001 specifies that the function can never fail
        with the error
      <span class="errorname">
       EINTR
      </span>
      .
     </p>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect3" name="pthreads-7_sect3" shape="rect">
     </a>
     <h3>
      Thread IDs
     </h3>
     <p>
      Each of the threads in a process has a unique thread
        identifier (stored in the type
      <em class="replaceable">
       <code>
        pthread_t
       </code>
      </em>
      ). This identifier
        is returned to the caller of
      <a class="link" href="../htmlman3/pthread_create.3.html" shape="rect" target="_top">
       <span class="citerefentry">
        <span class="refentrytitle">
         pthread_create
        </span>
        (3)
       </span>
      </a>
      , and a
        thread can obtain its own thread identifier using
      <a class="link" href="../htmlman3/pthread_self.3.html" shape="rect" target="_top">
       <span class="citerefentry">
        <span class="refentrytitle">
         pthread_self
        </span>
        (3)
       </span>
      </a>
      . Thread
        IDs are guaranteed to be unique only within a process. A
        thread ID may be reused after a terminated thread has been
        joined, or a detached thread has terminated. In all
        pthreads functions that accept a thread ID as an argument,
        that ID by definition refers to a thread in the same
        process as the caller.
     </p>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect4" name="pthreads-7_sect4" shape="rect">
     </a>
     <h3>
      Thread-safe functions
     </h3>
     <p>
      A thread-safe function is one that can be safely (i.e.,
        it will deliver the same results regardless of whether it
        is) called from multiple threads at the same time.
     </p>
     <p>
      POSIX.1-2001 and POSIX.1-2008 require that all functions
        specified in the standard shall be thread-safe, except for
        the following functions:
     </p>
     <div class="blockquote">
      <blockquote class="blockquote">
       <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
asctime()
basename()
catgets()
crypt()
ctermid() if passed a non-NULL argument
ctime()
dbm_clearerr()
dbm_close()
dbm_delete()
dbm_error()
dbm_fetch()
dbm_firstkey()
dbm_nextkey()
dbm_open()
dbm_store()
dirname()
dlerror()
drand48()
ecvt() [POSIX.1-2001 only (function removed in POSIX.1-2008)]
encrypt()
endgrent()
endpwent()
endutxent()
fcvt() [POSIX.1-2001 only (function removed in POSIX.1-2008)]
ftw()
gcvt() [POSIX.1-2001 only (function removed in POSIX.1-2008)]
getc_unlocked()
getchar_unlocked()
getdate()
getenv()
getgrent()
getgrgid()
getgrnam()
gethostbyaddr() [POSIX.1-2001 only (function removed in POSIX.1-2008)]
gethostbyname() [POSIX.1-2001 only (function removed in POSIX.1-2008)]
gethostent()
getlogin()
getnetbyaddr()
getnetbyname()
getnetent()
getopt()
getprotobyname()
getprotobynumber()
getprotoent()
getpwent()
getpwnam()
getpwuid()
getservbyname()
getservbyport()
getservent()
getutxent()
getutxid()
getutxline()
gmtime()
hcreate()
hdestroy()
hsearch()
inet_ntoa()
l64a()
lgamma()
lgammaf()
lgammal()
localeconv()
localtime()
lrand48()
mrand48()
nftw()
nl_langinfo()
ptsname()
putc_unlocked()
putchar_unlocked()
putenv()
pututxline()
rand()
readdir()
setenv()
setgrent()
setkey()
setpwent()
setutxent()
strerror()
strsignal() [Added in POSIX.1-2008]
strtok()
system() [Added in POSIX.1-2008]
tmpnam() if passed a non-NULL argument
ttyname()
unsetenv()
wcrtomb() if its final argument is NULL
wcsrtombs() if its final argument is NULL
wcstombs()
wctomb()
</pre>
       </div>
      </blockquote>
     </div>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect5" name="pthreads-7_sect5" shape="rect">
     </a>
     <h3>
      Async-cancel-safe functions
     </h3>
     <p>
      An async-cancel-safe function is one that can be safely
        called in an application where asynchronous cancelability
        is enabled (see
      <a class="link" href="../htmlman3/pthread_setcancelstate.3.html" shape="rect" target="_top">
       <span class="citerefentry">
        <span class="refentrytitle">
         pthread_setcancelstate
        </span>
        (3)
       </span>
      </a>
      ).
     </p>
     <p>
      Only the following functions are required to be
        async-cancel-safe by POSIX.1-2001 and POSIX.1-2008:
     </p>
     <div class="blockquote">
      <blockquote class="blockquote">
       <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
pthread_cancel()
pthread_setcancelstate()
pthread_setcanceltype()
</pre>
       </div>
      </blockquote>
     </div>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect6" name="pthreads-7_sect6" shape="rect">
     </a>
     <h3>
      Cancellation points
     </h3>
     <p>
      POSIX.1 specifies that certain functions must, and
        certain other functions may, be cancellation points. If a
        thread is cancelable, its cancelability type is deferred,
        and a cancellation request is pending for the thread, then
        the thread is canceled when it calls a function that is a
        cancellation point.
     </p>
     <p>
      The following functions are required to be cancellation
        points by POSIX.1-2001 and/or POSIX.1-2008:
     </p>
     <div class="blockquote">
      <blockquote class="blockquote">
       <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
accept()
aio_suspend()
clock_nanosleep()
close()
connect()
creat()
fcntl() F_SETLKW
fdatasync()
fsync()
getmsg()
getpmsg()
lockf() F_LOCK
mq_receive()
mq_send()
mq_timedreceive()
mq_timedsend()
msgrcv()
msgsnd()
msync()
nanosleep()
open()
openat() [Added in POSIX.1-2008]
pause()
poll()
pread()
pselect()
pthread_cond_timedwait()
pthread_cond_wait()
pthread_join()
pthread_testcancel()
putmsg()
putpmsg()
pwrite()
read()
readv()
recv()
recvfrom()
recvmsg()
select()
sem_timedwait()
sem_wait()
send()
sendmsg()
sendto()
sigpause() [POSIX.1-2001 only (moves to "may" list in POSIX.1-2008)]
sigsuspend()
sigtimedwait()
sigwait()
sigwaitinfo()
sleep()
system()
tcdrain()
usleep() [POSIX.1-2001 only (function removed in POSIX.1-2008)]
wait()
waitid()
waitpid()
write()
writev()
</pre>
       </div>
      </blockquote>
     </div>
     <p>
      The following functions may be cancellation points
        according to POSIX.1-2001 and/or POSIX.1-2008:
     </p>
     <div class="blockquote">
      <blockquote class="blockquote">
       <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
access()
asctime()
asctime_r()
catclose()
catgets()
catopen()
chmod() [Added in POSIX.1-2008]
chown() [Added in POSIX.1-2008]
closedir()
closelog()
ctermid()
ctime()
ctime_r()
dbm_close()
dbm_delete()
dbm_fetch()
dbm_nextkey()
dbm_open()
dbm_store()
dlclose()
dlopen()
dprintf() [Added in POSIX.1-2008]
endgrent()
endhostent()
endnetent()
endprotoent()
endpwent()
endservent()
endutxent()
faccessat() [Added in POSIX.1-2008]
fchmod() [Added in POSIX.1-2008]
fchmodat() [Added in POSIX.1-2008]
fchown() [Added in POSIX.1-2008]
fchownat() [Added in POSIX.1-2008]
fclose()
fcntl() (for any value of cmd argument)
fflush()
fgetc()
fgetpos()
fgets()
fgetwc()
fgetws()
fmtmsg()
fopen()
fpathconf()
fprintf()
fputc()
fputs()
fputwc()
fputws()
fread()
freopen()
fscanf()
fseek()
fseeko()
fsetpos()
fstat()
fstatat() [Added in POSIX.1-2008]
ftell()
ftello()
ftw()
futimens() [Added in POSIX.1-2008]
fwprintf()
fwrite()
fwscanf()
getaddrinfo()
getc()
getc_unlocked()
getchar()
getchar_unlocked()
getcwd()
getdate()
getdelim() [Added in POSIX.1-2008]
getgrent()
getgrgid()
getgrgid_r()
getgrnam()
getgrnam_r()
gethostbyaddr() [SUSv3 only (function removed in POSIX.1-2008)]
gethostbyname() [SUSv3 only (function removed in POSIX.1-2008)]
gethostent()
gethostid()
gethostname()
getline() [Added in POSIX.1-2008]
getlogin()
getlogin_r()
getnameinfo()
getnetbyaddr()
getnetbyname()
getnetent()
getopt() (if opterr is nonzero)
getprotobyname()
getprotobynumber()
getprotoent()
getpwent()
getpwnam()
getpwnam_r()
getpwuid()
getpwuid_r()
gets()
getservbyname()
getservbyport()
getservent()
getutxent()
getutxid()
getutxline()
getwc()
getwchar()
getwd() [SUSv3 only (function removed in POSIX.1-2008)]
glob()
iconv_close()
iconv_open()
ioctl()
link()
linkat() [Added in POSIX.1-2008]
lio_listio() [Added in POSIX.1-2008]
localtime()
localtime_r()
lockf() [Added in POSIX.1-2008]
lseek()
lstat()
mkdir() [Added in POSIX.1-2008]
mkdirat() [Added in POSIX.1-2008]
mkdtemp() [Added in POSIX.1-2008]
mkfifo() [Added in POSIX.1-2008]
mkfifoat() [Added in POSIX.1-2008]
mknod() [Added in POSIX.1-2008]
mknodat() [Added in POSIX.1-2008]
mkstemp()
mktime()
nftw()
opendir()
openlog()
pathconf()
pclose()
perror()
popen()
posix_fadvise()
posix_fallocate()
posix_madvise()
posix_openpt()
posix_spawn()
posix_spawnp()
posix_trace_clear()
posix_trace_close()
posix_trace_create()
posix_trace_create_withlog()
posix_trace_eventtypelist_getnext_id()
posix_trace_eventtypelist_rewind()
posix_trace_flush()
posix_trace_get_attr()
posix_trace_get_filter()
posix_trace_get_status()
posix_trace_getnext_event()
posix_trace_open()
posix_trace_rewind()
posix_trace_set_filter()
posix_trace_shutdown()
posix_trace_timedgetnext_event()
posix_typed_mem_open()
printf()
psiginfo() [Added in POSIX.1-2008]
psignal() [Added in POSIX.1-2008]
pthread_rwlock_rdlock()
pthread_rwlock_timedrdlock()
pthread_rwlock_timedwrlock()
pthread_rwlock_wrlock()
putc()
putc_unlocked()
putchar()
putchar_unlocked()
puts()
pututxline()
putwc()
putwchar()
readdir()
readdir_r()
readlink() [Added in POSIX.1-2008]
readlinkat() [Added in POSIX.1-2008]
remove()
rename()
renameat() [Added in POSIX.1-2008]
rewind()
rewinddir()
scandir() [Added in POSIX.1-2008]
scanf()
seekdir()
semop()
setgrent()
sethostent()
setnetent()
setprotoent()
setpwent()
setservent()
setutxent()
sigpause() [Added in POSIX.1-2008]
stat()
strerror()
strerror_r()
strftime()
symlink()
symlinkat() [Added in POSIX.1-2008]
sync()
syslog()
tmpfile()
tmpnam()
ttyname()
ttyname_r()
tzset()
ungetc()
ungetwc()
unlink()
unlinkat() [Added in POSIX.1-2008]
utime() [Added in POSIX.1-2008]
utimensat() [Added in POSIX.1-2008]
utimes() [Added in POSIX.1-2008]
vdprintf() [Added in POSIX.1-2008]
vfprintf()
vfwprintf()
vprintf()
vwprintf()
wcsftime()
wordexp()
wprintf()
wscanf()
</pre>
       </div>
      </blockquote>
     </div>
     <p>
      An implementation may also mark other functions not
        specified in the standard as cancellation points. In
        particular, an implementation is likely to mark any
        nonstandard function that may block as a cancellation
        point. (This includes most functions that can touch
        files.)
     </p>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect7" name="pthreads-7_sect7" shape="rect">
     </a>
     <h3>
      Compiling on Linux
     </h3>
     <p>
      On Linux, programs that use the Pthreads API should be
        compiled using
      <span class="emphasis">
       <em>
        cc
        &minus;pthread
       </em>
      </span>
      .
     </p>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect8" name="pthreads-7_sect8" shape="rect">
     </a>
     <h3>
      Linux implementations of POSIX threads
     </h3>
     <p>
      Over time, two threading implementations have been
        provided by the GNU C library on Linux:
     </p>
     <div class="variablelist">
      <dl class="variablelist">
       <dt>
        <span class="term">
         LinuxThreads
        </span>
       </dt>
       <dd>
        <p>
         This is the original Pthreads implementation.
              Since glibc 2.4, this implementation is no longer
              supported.
        </p>
       </dd>
       <dt>
        <span class="term">
         <code class="constant">
          NPTL
         </code>
         (Native POSIX Threads
            Library)
        </span>
       </dt>
       <dd>
        <p>
         This is the modern Pthreads implementation. By
              comparison with LinuxThreads, NPTL provides closer
              conformance to the requirements of the POSIX.1
              specification and better performance when creating
              large numbers of threads. NPTL is available since
              glibc 2.3.2, and requires features that are present
              in the Linux 2.6 kernel.
        </p>
       </dd>
      </dl>
     </div>
     <p>
      Both of these are so-called 1:1 implementations, meaning
        that each thread maps to a kernel scheduling entity. Both
        threading implementations employ the Linux
      <a class="link" href="../htmlman2/clone.2.html" shape="rect" target="_top">
       <span class="citerefentry">
        <span class="refentrytitle">
         clone
        </span>
        (2)
       </span>
      </a>
      system call. In
        NPTL, thread synchronization primitives (mutexes, thread
        joining, and so on) are implemented using the Linux
      <a class="link" href="../htmlman2/futex.2.html" shape="rect" target="_top">
       <span class="citerefentry">
        <span class="refentrytitle">
         futex
        </span>
        (2)
       </span>
      </a>
      system call.
     </p>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect9" name="pthreads-7_sect9" shape="rect">
     </a>
     <h3>
      LinuxThreads
     </h3>
     <p>
      The notable features of this implementation are the
        following:
     </p>
     <div class="itemizedlist">
      <ul class="itemizedlist" style="list-style-type: disc;">
       <li class="listitem">
        <p>
         In addition to the main (initial) thread, and the
              threads that the program creates using
         <a class="link" href="../htmlman3/pthread_create.3.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            pthread_create
           </span>
           (3)
          </span>
         </a>
         ,
              the implementation creates a "manager" thread. This
              thread handles thread creation and termination.
              (Problems can result if this thread is inadvertently
              killed.)
        </p>
       </li>
       <li class="listitem">
        <p>
         Signals are used internally by the implementation.
              On Linux 2.2 and later, the first three real-time
              signals are used (see also
         <a class="link" href="../htmlman7/signal.7.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            signal
           </span>
           (7)
          </span>
         </a>
         ). On
              older Linux kernels,
         <code class="constant">
          SIGUSR1
         </code>
         and
         <code class="constant">
          SIGUSR2
         </code>
         are used. Applications must
              avoid the use of whichever set of signals is employed
              by the implementation.
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads do not share process IDs. (In effect,
              LinuxThreads threads are implemented as processes
              which share more information than usual, but which do
              not share a common process ID.) LinuxThreads threads
              (including the manager thread) are visible as
              separate processes using
         <span class="citerefentry">
          <span class="refentrytitle">
           ps
          </span>
          (1)
         </span>
         .
        </p>
       </li>
      </ul>
     </div>
     <p>
      The LinuxThreads implementation deviates from the
        POSIX.1 specification in a number of ways, including the
        following:
     </p>
     <div class="itemizedlist">
      <ul class="itemizedlist" style="list-style-type: disc;">
       <li class="listitem">
        <p>
         Calls to
         <a class="link" href="../htmlman2/getpid.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            getpid
           </span>
           (2)
          </span>
         </a>
         return a
              different value in each thread.
        </p>
       </li>
       <li class="listitem">
        <p>
         Calls to
         <a class="link" href="../htmlman2/getpid.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            getppid
           </span>
           (2)
          </span>
         </a>
         in
              threads other than the main thread return the process
              ID of the manager thread; instead
         <a class="link" href="../htmlman2/getpid.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            getppid
           </span>
           (2)
          </span>
         </a>
         in these
              threads should return the same value as
         <a class="link" href="../htmlman2/getpid.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            getppid
           </span>
           (2)
          </span>
         </a>
         in the
              main thread.
        </p>
       </li>
       <li class="listitem">
        <p>
         When one thread creates a new child process using
         <a class="link" href="../htmlman2/fork.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            fork
           </span>
           (2)
          </span>
         </a>
         , any thread
              should be able to
         <a class="link" href="../htmlman2/wait.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            wait
           </span>
           (2)
          </span>
         </a>
         on the
              child. However, the implementation only allows the
              thread that created the child to
         <a class="link" href="../htmlman2/wait.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            wait
           </span>
           (2)
          </span>
         </a>
         on it.
        </p>
       </li>
       <li class="listitem">
        <p>
         When a thread calls
         <a class="link" href="../htmlman2/execve.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            execve
           </span>
           (2)
          </span>
         </a>
         , all
              other threads are terminated (as required by
              POSIX.1). However, the resulting process has the same
              PID as the thread that called
         <a class="link" href="../htmlman2/execve.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            execve
           </span>
           (2)
          </span>
         </a>
         : it
              should have the same PID as the main thread.
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads do not share user and group IDs. This can
              cause complications with set-user-ID programs and can
              cause failures in Pthreads functions if an
              application changes its credentials using
         <a class="link" href="../htmlman2/seteuid.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            seteuid
           </span>
           (2)
          </span>
         </a>
         or
              similar.
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads do not share a common session ID and
              process group ID.
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads do not share record locks created using
         <a class="link" href="../htmlman2/fcntl.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            fcntl
           </span>
           (2)
          </span>
         </a>
         .
        </p>
       </li>
       <li class="listitem">
        <p>
         The information returned by
         <a class="link" href="../htmlman2/times.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            times
           </span>
           (2)
          </span>
         </a>
         and
         <a class="link" href="../htmlman2/getrusage.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            getrusage
           </span>
           (2)
          </span>
         </a>
         is
              per-thread rather than process-wide.
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads do not share semaphore undo values (see
         <a class="link" href="../htmlman2/semop.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            semop
           </span>
           (2)
          </span>
         </a>
         ).
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads do not share interval timers.
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads do not share a common nice value.
        </p>
       </li>
       <li class="listitem">
        <p>
         POSIX.1 distinguishes the notions of signals that
              are directed to the process as a whole and signals
              that are directed to individual threads. According to
              POSIX.1, a process-directed signal (sent using
         <a class="link" href="../htmlman2/kill.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            kill
           </span>
           (2)
          </span>
         </a>
         , for
              example) should be handled by a single, arbitrarily
              selected thread within the process. LinuxThreads does
              not support the notion of process-directed signals:
              signals may be sent only to specific threads.
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads have distinct alternate signal stack
              settings. However, a new thread's alternate signal
              stack settings are copied from the thread that
              created it, so that the threads initially share an
              alternate signal stack. (A new thread should start
              with no alternate signal stack defined. If two
              threads handle signals on their shared alternate
              signal stack at the same time, unpredictable program
              failures are likely to occur.)
        </p>
       </li>
      </ul>
     </div>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect10" name="pthreads-7_sect10" shape="rect">
     </a>
     <h3>
      NPTL
     </h3>
     <p>
      With NPTL, all of the threads in a process are placed in
        the same thread group; all members of a thread group share
        the same PID. NPTL does not employ a manager thread. NPTL
        makes internal use of the first two real-time signals (see
        also
      <a class="link" href="../htmlman7/signal.7.html" shape="rect" target="_top">
       <span class="citerefentry">
        <span class="refentrytitle">
         signal
        </span>
        (7)
       </span>
      </a>
      ); these signals
        cannot be used in applications.
     </p>
     <p>
      NPTL still has at least one nonconformance with
        POSIX.1:
     </p>
     <div class="itemizedlist">
      <ul class="itemizedlist" style="list-style-type: disc;">
       <li class="listitem">
        <p>
         Threads do not share a common nice value.
        </p>
       </li>
      </ul>
     </div>
     <p>
      Some NPTL nonconformances occur only with older
        kernels:
     </p>
     <div class="itemizedlist">
      <ul class="itemizedlist" style="list-style-type: disc;">
       <li class="listitem">
        <p>
         The information returned by
         <a class="link" href="../htmlman2/times.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            times
           </span>
           (2)
          </span>
         </a>
         and
         <a class="link" href="../htmlman2/getrusage.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            getrusage
           </span>
           (2)
          </span>
         </a>
         is
              per-thread rather than process-wide (fixed in kernel
              2.6.9).
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads do not share resource limits (fixed in
              kernel 2.6.10).
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads do not share interval timers (fixed in
              kernel 2.6.12).
        </p>
       </li>
       <li class="listitem">
        <p>
         Only the main thread is permitted to start a new
              session using
         <a class="link" href="../htmlman2/setsid.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            setsid
           </span>
           (2)
          </span>
         </a>
         (fixed in
              kernel 2.6.16).
        </p>
       </li>
       <li class="listitem">
        <p>
         Only the main thread is permitted to make the
              process into a process group leader using
         <a class="link" href="../htmlman2/setpgid.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            setpgid
           </span>
           (2)
          </span>
         </a>
         (fixed
              in kernel 2.6.16).
        </p>
       </li>
       <li class="listitem">
        <p>
         Threads have distinct alternate signal stack
              settings. However, a new thread's alternate signal
              stack settings are copied from the thread that
              created it, so that the threads initially share an
              alternate signal stack (fixed in kernel 2.6.16).
        </p>
       </li>
      </ul>
     </div>
     <p>
      Note the following further points about the NPTL
        implementation:
     </p>
     <div class="itemizedlist">
      <ul class="itemizedlist" style="list-style-type: disc;">
       <li class="listitem">
        <p>
         If the stack size soft resource limit (see the
              description of
         <code class="constant">
          RLIMIT_STACK
         </code>
         in
         <a class="link" href="../htmlman2/getrlimit.2.html" shape="rect" target="_top">
          <span class="citerefentry">
           <span class="refentrytitle">
            setrlimit
           </span>
           (2)
          </span>
         </a>
         ) is
              set to a value other than
         <em class="replaceable">
          <code>
           unlimited
          </code>
         </em>
         , then this
              value defines the default stack size for new threads.
              To be effective, this limit must be set before the
              program is executed, perhaps using the
         <span class="emphasis">
          <em>
           ulimit -s
          </em>
         </span>
         shell built-in
              command (
         <span class="emphasis">
          <em>
           limit
              stacksize
          </em>
         </span>
         in the C shell).
        </p>
       </li>
      </ul>
     </div>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect11" name="pthreads-7_sect11" shape="rect">
     </a>
     <h3>
      Determining the threading implementation
     </h3>
     <p>
      Since glibc 2.3.2, the
      <span class="citerefentry">
       <span class="refentrytitle">
        getconf
       </span>
       (1)
      </span>
      command can be
        used to determine the system's threading implementation,
        for example:
     </p>
     <div class="blockquote">
      <blockquote class="blockquote">
       <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
bash$ getconf GNU_LIBPTHREAD_VERSION
NPTL 2.3.4
</pre>
       </div>
      </blockquote>
     </div>
     <p>
      With older glibc versions, a command such as the
        following should be sufficient to determine the default
        threading implementation:
     </p>
     <div class="blockquote">
      <blockquote class="blockquote">
       <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
bash$ $( ldd /bin/ls | grep libc.so | awk '{print $3}' ) | \
                egrep &minus;i 'threads|nptl'
        Native POSIX Threads Library by Ulrich Drepper et al
</pre>
       </div>
      </blockquote>
     </div>
    </div>
    <div class="refsect2">
     <a id="pthreads-7_sect12" name="pthreads-7_sect12" shape="rect">
     </a>
     <h3>
      Selecting the threading implementation:
        LD_ASSUME_KERNEL
     </h3>
     <p>
      On systems with a glibc that supports both LinuxThreads
        and NPTL (i.e., glibc 2.3.
      <em class="replaceable">
       <code>
        x
       </code>
      </em>
      ), the
      <code class="constant">
       LD_ASSUME_KERNEL
      </code>
      environment variable can
        be used to override the dynamic linker's default choice of
        threading implementation. This variable tells the dynamic
        linker to assume that it is running on top of a particular
        kernel version. By specifying a kernel version that does
        not provide the support required by NPTL, we can force the
        use of LinuxThreads. (The most likely reason for doing this
        is to run a (broken) application that depends on some
        nonconformant behavior in LinuxThreads.) For example:
     </p>
     <div class="blockquote">
      <blockquote class="blockquote">
       <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
bash$ $( LD_ASSUME_KERNEL=2.2.5 ldd /bin/ls | grep libc.so | \
                awk '{print $3}' ) | egrep &minus;i 'threads|ntpl'
        linuxthreads-0.10 by Xavier Leroy
</pre>
       </div>
      </blockquote>
     </div>
    </div>
   </div>
   <div class="refsect1">
    <a id="pthreads-7_sect13" name="pthreads-7_sect13" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman2/clone.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        clone
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/futex.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        futex
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/gettid.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        gettid
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman5/proc.5.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        proc
       </span>
       (5)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/futex.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        futex
       </span>
       (7)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/sigevent.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        sigevent
       </span>
       (7)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/signal.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        signal
       </span>
       (7)
      </span>
     </a>
     ,
    </p>
    <p>
     Various Pthreads manual pages, for example:
     <a class="link" href="../htmlman3/pthread_attr_init.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_attr_init
       </span>
       (3)
      </span>
     </a>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       pthread_atfork
      </span>
      (3)
     </span>
     ,
     <a class="link" href="../htmlman3/pthread_cancel.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_cancel
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_cleanup_push.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_cleanup_push
       </span>
       (3)
      </span>
     </a>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       pthread_cond_signal
      </span>
      (3)
     </span>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       pthread_cond_wait
      </span>
      (3)
     </span>
     ,
     <a class="link" href="../htmlman3/pthread_create.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_create
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_detach.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_detach
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_equal.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_equal
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_exit.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_exit
       </span>
       (3)
      </span>
     </a>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       pthread_key_create
      </span>
      (3)
     </span>
     ,
     <a class="link" href="../htmlman3/pthread_kill.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_kill
       </span>
       (3)
      </span>
     </a>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       pthread_mutex_lock
      </span>
      (3)
     </span>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       pthread_mutex_unlock
      </span>
      (3)
     </span>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       pthread_once
      </span>
      (3)
     </span>
     ,
     <a class="link" href="../htmlman3/pthread_setcancelstate.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_setcancelstate
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_setcancelstate.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_setcanceltype
       </span>
       (3)
      </span>
     </a>
     ,
     <span class="citerefentry">
      <span class="refentrytitle">
       pthread_setspecific
      </span>
      (3)
     </span>
     ,
     <a class="link" href="../htmlman3/pthread_sigmask.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_sigmask
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/pthread_sigqueue.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_sigqueue
       </span>
       (3)
      </span>
     </a>
     , and
     <a class="link" href="../htmlman3/pthread_testcancel.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        pthread_testcancel
       </span>
       (3)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="pthreads-7_sect14" name="pthreads-7_sect14" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
