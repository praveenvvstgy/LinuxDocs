<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   ocsptool(1) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="ocsptool(1) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="ocsptool.1" name="ocsptool.1" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     ocsptool &mdash; GnuTLS OCSP tool
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="cmdsynopsis">
     <p>
      <code class="command">
       ocsptool
      </code>
      [
      <code class="option">
       &minus;flag
      </code>
      [
      <em class="replaceable">
       <code>
        value
       </code>
      </em>
      ] ...] [
      <code class="option">
       &minus;&minus;opt&minus;name
      </code>
      [
      <em class="replaceable">
       <code>
        [=|]value
       </code>
      </em>
      ] ...]
     </p>
    </div>
   </div>
   <div class="refsect1">
    <a id="ocsptool-1_sect1" name="ocsptool-1_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     Ocsptool is a program that can parse and print information
      about OCSP requests/responses, generate requests and verify
      responses.
    </p>
   </div>
   <div class="refsect1">
    <a id="ocsptool-1_sect2" name="ocsptool-1_sect2" shape="rect">
    </a>
    <h2>
     OPTIONS
    </h2>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <code class="option">
         &minus;d
         <em class="parameter">
          <code>
           number
          </code>
         </em>
         ,
          &minus;&minus;debug=
         <em class="parameter">
          <code>
           number
          </code>
         </em>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Enable debugging. This option takes an integer
            number as its argument. The value of
        <span class="command">
         <strong>
          number
         </strong>
        </span>
        is constrained
            to being:
       </p>
       <div class="blockquote">
        <blockquote class="blockquote">
         <div class="informalexample">
          <pre class="programlisting" xml:space="preserve">
in the range  0 through 9999
</pre>
         </div>
        </blockquote>
       </div>
       <p>
        Specifies the debug level.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;V,
          &minus;&minus;verbose
        </code>
       </span>
      </dt>
      <dd>
       <p>
        More verbose output. This option may appear an
            unlimited number of times.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;&minus;infile=
         <em class="parameter">
          <code>
           file
          </code>
         </em>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Input file.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;&minus;outfile=
         <em class="parameter">
          <code>
           string
          </code>
         </em>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Output file.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;&minus;ask[=
         <span class="emphasis">
          <em>
           server
          name|url
          </em>
         </span>
         ]
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Ask an OCSP/HTTP server on a certificate validity.
            This option must appear in combination with the
            following options: load-cert, load-issuer.
       </p>
       <p>
        Connects to the specified HTTP OCSP server and
            queries on the validity of the loaded certificate.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;e,
          &minus;&minus;verify&minus;response
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Verify response.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;i,
          &minus;&minus;request&minus;info
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Print information on a OCSP request.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;j,
          &minus;&minus;response&minus;info
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Print information on a OCSP response.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;q,
          &minus;&minus;generate&minus;request
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Generate an OCSP request.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;&minus;nonce,
         <code class="option">
          &minus;&minus;no&minus;nonce
         </code>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Use (or not) a nonce to OCSP request. The
        <em class="replaceable">
         <code>
          no&minus;nonce
         </code>
        </em>
        form
            will disable the option.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;&minus;load&minus;issuer=
         <em class="parameter">
          <code>
           file
          </code>
         </em>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Read issuer certificate from file.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;&minus;load&minus;cert=
         <em class="parameter">
          <code>
           file
          </code>
         </em>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Read certificate to check from file.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;&minus;load&minus;trust=
         <em class="parameter">
          <code>
           file
          </code>
         </em>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Read OCSP trust anchors from file. This option must
            not appear in combination with any of the following
            options: load-signer.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;&minus;load&minus;signer=
         <em class="parameter">
          <code>
           file
          </code>
         </em>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Read OCSP response signer from file. This option
            must not appear in combination with any of the
            following options: load-trust.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;&minus;inder,
         <code class="option">
          &minus;&minus;no&minus;inder
         </code>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Use DER format for input certificates and private
            keys. The
        <em class="replaceable">
         <code>
          no&minus;inder
         </code>
        </em>
        form
            will disable the option.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;Q
         <em class="parameter">
          <code>
           file
          </code>
         </em>
         ,
          &minus;&minus;load&minus;request=
         <em class="parameter">
          <code>
           file
          </code>
         </em>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Read DER encoded OCSP request from file.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;S
         <em class="parameter">
          <code>
           file
          </code>
         </em>
         ,
          &minus;&minus;load&minus;response=
         <em class="parameter">
          <code>
           file
          </code>
         </em>
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Read DER encoded OCSP response from file.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;h,
          &minus;&minus;help
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Display usage information and exit.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;!,
          &minus;&minus;more&minus;help
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Pass the extended usage information through a
            pager.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="option">
         &minus;v
          [{
         <em class="replaceable">
          <code>
           v|c|n
          </code>
         </em>
         }],
          &minus;&minus;version[={
         <em class="replaceable">
          <code>
           v|c|n
          </code>
         </em>
         }]
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Output version of program and exit. The default mode
            is `v', a simple version. The `c' mode will print
            copyright information and `n' will print the full
            copyright notice.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1">
    <a id="ocsptool-1_sect3" name="ocsptool-1_sect3" shape="rect">
    </a>
    <h2>
     EXAMPLES
    </h2>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
<span class="emphasis"><em>Print information about an OCSP request</em></span>
</pre>
    </div>
    <p>
     To parse an OCSP request and print information about the
      content, the
     <code class="option">
      &minus;i
     </code>
     or
     <code class="option">
      &minus;&minus;request&minus;info
     </code>
     parameter may be used as follows. The
     <code class="option">
      &minus;Q
     </code>
     parameter specify the name of the
      file containing the OCSP request, and it should contain the
      OCSP request in binary DER format.
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$ ocsptool &minus;i &minus;Q ocsp&minus;request.der
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     The input file may also be sent to standard input like
      this:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$ cat ocsp&minus;request.der | ocsptool &minus;&minus;request&minus;info
</pre>
      </div>
     </blockquote>
    </div>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
<span class="emphasis"><em>Print information about an OCSP response</em></span>
</pre>
    </div>
    <p>
     Similar to parsing OCSP requests, OCSP responses can be
      parsed using the
     <code class="option">
      &minus;j
     </code>
     or
     <code class="option">
      &minus;&minus;response&minus;info
     </code>
     as follows.
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$ ocsptool &minus;j &minus;Q ocsp&minus;response.der
$ cat ocsp&minus;response.der | ocsptool &minus;&minus;response&minus;info
</pre>
      </div>
     </blockquote>
    </div>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
<span class="emphasis"><em>Generate an OCSP request</em></span>
</pre>
    </div>
    <p>
     The
     <code class="option">
      &minus;q
     </code>
     or
     <code class="option">
      &minus;&minus;generate&minus;request
     </code>
     parameters are used to generate an OCSP request. By default
      the OCSP request is written to standard output in binary DER
      format, but can be stored in a file using
     <code class="option">
      &minus;&minus;outfile
     </code>
     . To generate an OCSP
      request the issuer of the certificate to check needs to be
      specified with
     <code class="option">
      &minus;&minus;load&minus;issuer
     </code>
     and the
      certificate to check with
     <code class="option">
      &minus;&minus;load&minus;cert
     </code>
     . By default PEM
      format is used for these files, although
     <code class="option">
      &minus;&minus;inder
     </code>
     can be used to specify
      that the input files are in DER format.
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$ ocsptool &minus;q &minus;&minus;load&minus;issuer issuer.pem &minus;&minus;load&minus;cert client.pem            &minus;&minus;outfile ocsp&minus;request.der
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     When generating OCSP requests, the tool will add an OCSP
      extension containing a nonce. This behaviour can be disabled
      by specifying
     <code class="option">
      &minus;&minus;no&minus;nonce
     </code>
     .
    </p>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
<span class="emphasis"><em>Verify signature in OCSP response</em></span>
</pre>
    </div>
    <p>
     To verify the signature in an OCSP response the
     <code class="option">
      &minus;e
     </code>
     or
     <code class="option">
      &minus;&minus;verify&minus;response
     </code>
     parameter
      is used. The tool will read an OCSP response in DER format
      from standard input, or from the file specified by
     <code class="option">
      &minus;&minus;load&minus;response
     </code>
     . The OCSP
      response is verified against a set of trust anchors, which
      are specified using
     <code class="option">
      &minus;&minus;load&minus;trust
     </code>
     . The trust
      anchors are concatenated certificates in PEM format. The
      certificate that signed the OCSP response needs to be in the
      set of trust anchors, or the issuer of the signer certificate
      needs to be in the set of trust anchors and the OCSP Extended
      Key Usage bit has to be asserted in the signer
      certificate.
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$ ocsptool &minus;e &minus;&minus;load&minus;trust issuer.pem            &minus;&minus;load&minus;response ocsp&minus;response.der
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     The tool will print status of verification.
    </p>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
<span class="emphasis"><em>Verify signature in OCSP response against given certificate</em></span>
</pre>
    </div>
    <p>
     It is possible to override the normal trust logic if you
      know that a certain certificate is supposed to have signed
      the OCSP response, and you want to use it to check the
      signature. This is achieved using
     <code class="option">
      &minus;&minus;load&minus;signer
     </code>
     instead of
     <code class="option">
      &minus;&minus;load&minus;trust
     </code>
     .
      This will load one certificate and it will be used to verify
      the signature in the OCSP response. It will not check the
      Extended Key Usage bit.
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$ ocsptool &minus;e &minus;&minus;load&minus;signer ocsp&minus;signer.pem            &minus;&minus;load&minus;response ocsp&minus;response.der
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     This approach is normally only relevant in two situations.
      The first is when the OCSP response does not contain a copy
      of the signer certificate, so the
     <code class="option">
      &minus;&minus;load&minus;trust
     </code>
     code would
      fail. The second is if you want to avoid the indirect mode
      where the OCSP response signer certificate is signed by a
      trust anchor.
    </p>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
<span class="emphasis"><em>Real&minus;world example</em></span>
</pre>
    </div>
    <p>
     Here is an example of how to generate an OCSP request for
      a certificate and to verify the response. For illustration
      we'll use the
     <em class="replaceable">
      <code>
       blog.josefsson.org
      </code>
     </em>
     host,
      which (as of writing) uses a certificate from CACert. First
      we'll use
     <em class="replaceable">
      <code>
       gnutls&minus;cli
      </code>
     </em>
     to get a
      copy of the server certificate chain. The server is not
      required to send this information, but this particular one is
      configured to do so.
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$ echo | gnutls&minus;cli &minus;p 443 blog.josefsson.org &minus;&minus;print&minus;cert &gt; chain.pem
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     Use a text editor on
     <em class="replaceable">
      <code>
       chain.pem
      </code>
     </em>
     to create three
      files for each separate certificates, called
     <em class="replaceable">
      <code>
       cert.pem
      </code>
     </em>
     for the first
      certificate for the domain itself, secondly
     <em class="replaceable">
      <code>
       issuer.pem
      </code>
     </em>
     for the
      intermediate certificate and
     <em class="replaceable">
      <code>
       root.pem
      </code>
     </em>
     for the final root
      certificate.
    </p>
    <p>
     The domain certificate normally contains a pointer to
      where the OCSP responder is located, in the Authority
      Information Access Information extension. For example, from
     <span class="emphasis">
      <em>
       certtool &minus;i &lt;
      cert.pem
      </em>
     </span>
     there is this information:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
Authority Information Access Information (not critical):
Access Method: 1.3.6.1.5.5.7.48.1 (id&minus;ad&minus;ocsp)
Access Location URI: http://ocsp.CAcert.org/
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     This means the CA support OCSP queries over HTTP. We are
      now ready to create a OCSP request for the certificate.
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
$ ocsptool &minus;&minus;ask ocsp.CAcert.org &minus;&minus;load&minus;issuer issuer.pem            &minus;&minus;load&minus;cert cert.pem &minus;&minus;outfile ocsp&minus;response.der
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     The request is sent via HTTP to the OCSP server address
      specified. If the address is ommited ocsptool will use the
      address stored in the certificate.
    </p>
   </div>
   <div class="refsect1">
    <a id="ocsptool-1_sect4" name="ocsptool-1_sect4" shape="rect">
    </a>
    <h2>
     EXIT STATUS
    </h2>
    <p>
     One of the following exit values will be returned:
    </p>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
<code class="constant">0</code> (EXIT_SUCCESS)
</pre>
    </div>
    <p>
     Successful program execution.
    </p>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
<code class="constant">1</code> (EXIT_FAILURE)
</pre>
    </div>
    <p>
     The operation failed or the command syntax was not
      valid.
    </p>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
<code class="constant">70</code> (EX_SOFTWARE)
</pre>
    </div>
    <p>
     libopts had an internal operational error. Please report
      it to autogen-users@lists.sourceforge.net. Thank you.
    </p>
   </div>
   <div class="refsect1">
    <a id="ocsptool-1_sect5" name="ocsptool-1_sect5" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     certtool (1)
    </p>
   </div>
   <div class="refsect1">
    <a id="ocsptool-1_sect6" name="ocsptool-1_sect6" shape="rect">
    </a>
    <h2>
     AUTHORS
    </h2>
    <p>
     Nikos Mavrogiannopoulos, Simon Josefsson and others; see
      /usr/share/doc/gnutls/AUTHORS for a complete list.
    </p>
   </div>
   <div class="refsect1">
    <a id="ocsptool-1_sect8" name="ocsptool-1_sect8" shape="rect">
    </a>
    <h2>
     BUGS
    </h2>
    <p>
     Please send bug reports to: bugs@gnutls.org
    </p>
   </div>
   <div class="refsect1">
    <a id="ocsptool-1_sect9" name="ocsptool-1_sect9" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     This manual page was
     <span class="command">
      <strong>
       AutoGen
      </strong>
     </span>
     -erated from the
     <span class="command">
      <strong>
       ocsptool
      </strong>
     </span>
     option
      definitions.
    </p>
   </div>
  </div>
 </body>
</html>
