<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   gettimeofday(2) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="gettimeofday(2) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="gettimeofday.2" name="gettimeofday.2" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     gettimeofday, settimeofday &mdash; get / set time
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="funcsynopsis">
     <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;sys/time.h&gt;
</pre>
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          gettimeofday
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        struct timeval *
        <var class="pdparam">
         tv
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        struct timezone *
        <var class="pdparam">
         tz
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          settimeofday
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        const struct timeval *
        <var class="pdparam">
         tv
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const struct timezone *
        <var class="pdparam">
         tz
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
     <table border="0" summary="Note">
      <tr>
       <td align="center" colspan="1" rowspan="2" valign="top" width="25">
        <img alt="[Note]" src="../stylesheet/note.png"/>
       </td>
       <th align="left" colspan="1" rowspan="1">
        Note
       </th>
      </tr>
      <tr>
       <td align="left" colspan="1" rowspan="1" valign="top">
        <div class="featuretests">
         <table style="border-collapse: collapse;">
          <colgroup span="1">
           <col span="1">
           </col>
          </colgroup>
          <thead>
           <tr>
            <th colspan="1" rowspan="1" style="">
             Feature Test Macro Requirements
                      for glibc (see
             <a class="link" href="../htmlman7/feature_test_macros.7.html" shape="rect" target="_top">
              <span class="citerefentry">
               <span class="refentrytitle">
                feature_test_macros
               </span>
               (7)
              </span>
             </a>
             ):
            </th>
           </tr>
          </thead>
          <tbody>
           <tr>
            <td colspan="1" rowspan="1" style="">
             <code class="function">
              settimeofday
             </code>
             ():
            </td>
           </tr>
           <tr>
            <td class="featuretestdef" colspan="1" rowspan="1" style="">
             <code class="constant">
              _BSD_SOURCE
             </code>
            </td>
           </tr>
          </tbody>
         </table>
        </div>
       </td>
      </tr>
     </table>
    </div>
   </div>
   <div class="refsect1">
    <a id="gettimeofday-2_sect1" name="gettimeofday-2_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     The functions
     <code class="function">
      gettimeofday
     </code>
     ()
      and
     <code class="function">
      settimeofday
     </code>
     () can get and
      set the time as well as a timezone. The
     <em class="parameter">
      <code>
       tv
      </code>
     </em>
     argument is a
     <span class="emphasis">
      <em>
       struct timeval
      </em>
     </span>
     (as specified in
     <code class="literal">
      &lt;
     </code>
     <code class="filename">
      sys/time.h
     </code>
     <code class="literal">
      &gt;
     </code>
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="structdef">
       <table style="border-collapse: collapse;">
        <colgroup span="1">
         <col class="c1" span="1">
         </col>
         <col class="c2" span="1">
         </col>
         <col class="c3" span="1">
         </col>
         <col class="c4" span="1">
         </col>
         <col class="c5" span="1">
         </col>
        </colgroup>
        <tbody>
         <tr>
          <td align="left" class="structdefhdr" colspan="1" rowspan="1" style="">
           struct
          </td>
          <td align="left" class="structdefhdr" colspan="4" rowspan="1" style="">
           <span class="structname">
            timeval
           </span>
           &nbsp;{
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            time_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             tv_sec
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;seconds&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            suseconds_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             tv_usec
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;microseconds&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
           };
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </blockquote>
    </div>
    <p>
     and gives the number of seconds and microseconds since the
      Epoch (see
     <a class="link" href="../htmlman2/time.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        time
       </span>
       (2)
      </span>
     </a>
     ). The
     <em class="parameter">
      <code>
       tz
      </code>
     </em>
     argument is a
     <span class="emphasis">
      <em>
       struct timezone
      </em>
     </span>
     :
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="structdef">
       <table style="border-collapse: collapse;">
        <colgroup span="1">
         <col class="c1" span="1">
         </col>
         <col class="c2" span="1">
         </col>
         <col class="c3" span="1">
         </col>
         <col class="c4" span="1">
         </col>
         <col class="c5" span="1">
         </col>
        </colgroup>
        <tbody>
         <tr>
          <td align="left" class="structdefhdr" colspan="1" rowspan="1" style="">
           struct
          </td>
          <td align="left" class="structdefhdr" colspan="4" rowspan="1" style="">
           <span class="structname">
            timezone
           </span>
           &nbsp;{
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            int
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             tz_minuteswest
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;minutes&nbsp;west&nbsp;of&nbsp;Greenwich&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            int
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             tz_dsttime
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;type&nbsp;of&nbsp;DST&nbsp;correction&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
           };
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </blockquote>
    </div>
    <p>
     If either
     <em class="parameter">
      <code>
       tv
      </code>
     </em>
     or
     <em class="parameter">
      <code>
       tz
      </code>
     </em>
     is NULL, the
      corresponding structure is not set or returned. (However,
      compilation warnings will result if
     <em class="parameter">
      <code>
       tv
      </code>
     </em>
     is NULL.)
    </p>
    <p>
     The use of the
     <span class="structname">
      timezone
     </span>
     structure is obsolete; the
     <em class="parameter">
      <code>
       tz
      </code>
     </em>
     argument should normally be
      specified as NULL. (See NOTES below.)
    </p>
    <p>
     Under Linux, there are some peculiar "warp clock"
      semantics associated with the
     <code class="function">
      settimeofday
     </code>
     () system call if on the very
      first call (after booting) that has a non-NULL
     <em class="parameter">
      <code>
       tz
      </code>
     </em>
     argument, the
     <em class="parameter">
      <code>
       tv
      </code>
     </em>
     argument is NULL and the
     <em class="parameter">
      <code>
       tz_minuteswest
      </code>
     </em>
     field
      is nonzero. (The
     <em class="parameter">
      <code>
       tz_dsttime
      </code>
     </em>
     field should be zero
      for this case.) In such a case it is assumed that the CMOS
      clock is on local time, and that it has to be incremented by
      this amount to get UTC system time. No doubt it is a bad idea
      to use this feature.
    </p>
   </div>
   <div class="refsect1">
    <a id="gettimeofday-2_sect2" name="gettimeofday-2_sect2" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     <code class="function">
      gettimeofday
     </code>
     () and
     <code class="function">
      settimeofday
     </code>
     () return 0 for
      success, or &minus;1 for failure (in which case
     <code class="varname">
      errno
     </code>
     is set appropriately).
    </p>
   </div>
   <div class="refsect1">
    <a id="gettimeofday-2_sect3" name="gettimeofday-2_sect3" shape="rect">
    </a>
    <h2>
     ERRORS
    </h2>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <span class="errorname">
         EFAULT
        </span>
       </span>
      </dt>
      <dd>
       <p>
        One of
        <em class="parameter">
         <code>
          tv
         </code>
        </em>
        or
        <em class="parameter">
         <code>
          tz
         </code>
        </em>
        pointed
            outside the accessible address space.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EINVAL
        </span>
       </span>
      </dt>
      <dd>
       <p>
        Timezone (or something else) is invalid.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EPERM
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The calling process has insufficient privilege to
            call
        <code class="function">
         settimeofday
        </code>
        ();
            under Linux the
        <code class="constant">
         CAP_SYS_TIME
        </code>
        capability is
            required.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1">
    <a id="gettimeofday-2_sect4" name="gettimeofday-2_sect4" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     SVr4, 4.3BSD. POSIX.1-2001 describes
     <code class="function">
      gettimeofday
     </code>
     () but not
     <code class="function">
      settimeofday
     </code>
     (). POSIX.1-2008 marks
     <code class="function">
      gettimeofday
     </code>
     () as obsolete,
      recommending the use of
     <a class="link" href="../htmlman2/clock_getres.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        clock_gettime
       </span>
       (2)
      </span>
     </a>
     instead.
    </p>
   </div>
   <div class="refsect1">
    <a id="gettimeofday-2_sect5" name="gettimeofday-2_sect5" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     The time returned by
     <code class="function">
      gettimeofday
     </code>
     ()
     <em class="replaceable">
      <code>
       is
      </code>
     </em>
     affected by discontinuous
      jumps in the system time (e.g., if the system administrator
      manually changes the system time). If you need a
      monotonically increasing clock, see
     <a class="link" href="../htmlman2/clock_getres.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        clock_gettime
       </span>
       (2)
      </span>
     </a>
     .
    </p>
    <p>
     Macros for operating on
     <span class="structname">
      timeval
     </span>
     structures are described in
     <a class="link" href="../htmlman3/timeradd.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        timeradd
       </span>
       (3)
      </span>
     </a>
     .
    </p>
    <p>
     Traditionally, the fields of
     <span class="emphasis">
      <em>
       struct timeval
      </em>
     </span>
     were of type
     <span class="type">
      long
     </span>
     .
    </p>
    <p>
     The
     <em class="parameter">
      <code>
       tz_dsttime
      </code>
     </em>
     field has never been used under Linux. Thus, the following is
      purely of historic interest.
    </p>
    <p>
     On old systems, the field
     <em class="parameter">
      <code>
       tz_dsttime
      </code>
     </em>
     contains a symbolic
      constant (values are given below) that indicates in which
      part of the year Daylight Saving Time is in force.
    </p>
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
     <table border="0" summary="Note">
      <tr>
       <td align="center" colspan="1" rowspan="2" valign="top" width="25">
        <img alt="[Note]" src="../stylesheet/note.png"/>
       </td>
       <th align="left" colspan="1" rowspan="1">
        Note
       </th>
      </tr>
      <tr>
       <td align="left" colspan="1" rowspan="1" valign="top">
        <p>
         This value is constant throughout the year: it
              does not indicate that DST is in force, it just
              selects an algorithm.
        </p>
       </td>
      </tr>
     </table>
    </div>
    <p>
     The daylight saving time algorithms defined are as
      follows:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="informalexample">
       <pre class="programlisting" xml:space="preserve">
<code class="constant">DST_NONE</code>     /* not on DST */
<code class="constant">DST_USA</code>      /* USA style DST */
<code class="constant">DST_AUST</code>     /* Australian style DST */
<code class="constant">DST_WET</code>      /* Western European DST */
<code class="constant">DST_MET</code>      /* Middle European DST */
<code class="constant">DST_EET</code>      /* Eastern European DST */
<code class="constant">DST_CAN</code>      /* Canada */
<code class="constant">DST_GB</code>       /* Great Britain and Eire */
<code class="constant">DST_RUM</code>      /* Romania */
<code class="constant">DST_TUR</code>      /* Turkey */
<code class="constant">DST_AUSTALT</code>  /* Australian style with shift in 1986 */
</pre>
      </div>
     </blockquote>
    </div>
    <p>
     Of course it turned out that the period in which Daylight
      Saving Time is in force cannot be given by a simple
      algorithm, one per country; indeed, this period is determined
      by unpredictable political decisions. So this method of
      representing timezones has been abandoned.
    </p>
   </div>
   <div class="refsect1">
    <a id="gettimeofday-2_sect6" name="gettimeofday-2_sect6" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman1/date.1.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        date
       </span>
       (1)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/adjtimex.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        adjtimex
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/clock_getres.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        clock_gettime
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/time.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        time
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/ctime.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        ctime
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/ftime.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        ftime
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/timeradd.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        timeradd
       </span>
       (3)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/capabilities.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        capabilities
       </span>
       (7)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/time.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        time
       </span>
       (7)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="gettimeofday-2_sect7" name="gettimeofday-2_sect7" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
