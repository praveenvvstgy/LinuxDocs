<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   msgctl(2) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="msgctl(2) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="msgctl.2" name="msgctl.2" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     msgctl &mdash; System V message control operations
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
#include &lt;sys/types.h&gt;
#include &lt;sys/ipc.h&gt;
#include &lt;sys/msg.h&gt;
</pre>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          msgctl
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         msqid
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         cmd
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        struct msqid_ds *
        <var class="pdparam">
         buf
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
   </div>
   <div class="refsect1">
    <a id="msgctl-2_sect1" name="msgctl-2_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     <code class="function">
      msgctl
     </code>
     () performs the
      control operation specified by
     <em class="parameter">
      <code>
       cmd
      </code>
     </em>
     on the System V message
      queue with identifier
     <em class="parameter">
      <code>
       msqid
      </code>
     </em>
     .
    </p>
    <p>
     The
     <span class="structname">
      msqid_ds
     </span>
     data
      structure is defined in
     <code class="literal">
      &lt;
     </code>
     <code class="filename">
      sys/msg.h
     </code>
     <code class="literal">
      &gt;
     </code>
     as follows:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="structdef">
       <table style="border-collapse: collapse;">
        <colgroup span="1">
         <col class="c1" span="1">
         </col>
         <col class="c2" span="1">
         </col>
         <col class="c3" span="1">
         </col>
         <col class="c4" span="1">
         </col>
         <col class="c5" span="1">
         </col>
        </colgroup>
        <tbody>
         <tr>
          <td align="left" class="structdefhdr" colspan="1" rowspan="1" style="">
           struct
          </td>
          <td align="left" class="structdefhdr" colspan="4" rowspan="1" style="">
           <span class="structname">
            msqid_ds
           </span>
           &nbsp;{
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            struct&nbsp;ipc_perm
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             msg_perm
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Ownership&nbsp;and&nbsp;permissions&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            time_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             msg_stime
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Time&nbsp;of&nbsp;last&nbsp;msgsnd(2)&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            time_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             msg_rtime
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Time&nbsp;of&nbsp;last&nbsp;msgrcv(2)&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            time_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             msg_ctime
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Time&nbsp;of&nbsp;last&nbsp;change&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            unsigned&nbsp;long
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             __msg_cbytes
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Current&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in
            <br/>
            queue&nbsp;(nonstandard)&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            msgqnum_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             msg_qnum
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Current&nbsp;number&nbsp;of&nbsp;messages
            <br/>
            in&nbsp;queue&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            msglen_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             msg_qbytes
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;bytes
            <br/>
            allowed&nbsp;in&nbsp;queue&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            pid_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             msg_lspid
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;PID&nbsp;of&nbsp;last&nbsp;msgsnd(2)&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            pid_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             msg_lrpid
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;PID&nbsp;of&nbsp;last&nbsp;msgrcv(2)&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
           };
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </blockquote>
    </div>
    <p>
     The
     <em class="replaceable">
      <code>
       ipc_perm
      </code>
     </em>
     structure is defined as follows (the highlighted fields are
      settable using
     <code class="constant">
      IPC_SET
     </code>
     ):
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="structdef">
       <table style="border-collapse: collapse;">
        <colgroup span="1">
         <col class="c1" span="1">
         </col>
         <col class="c2" span="1">
         </col>
         <col class="c3" span="1">
         </col>
         <col class="c4" span="1">
         </col>
         <col class="c5" span="1">
         </col>
        </colgroup>
        <tbody>
         <tr>
          <td align="left" class="structdefhdr" colspan="1" rowspan="1" style="">
           struct
          </td>
          <td align="left" class="structdefhdr" colspan="4" rowspan="1" style="">
           <span class="structname">
            ipc_perm
           </span>
           &nbsp;{
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            key_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             __key
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Key&nbsp;supplied&nbsp;to&nbsp;msgget(2)&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            uid_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             uid
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Effective&nbsp;UID&nbsp;of&nbsp;owner&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            gid_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             gid
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Effective&nbsp;GID&nbsp;of&nbsp;owner&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            uid_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             cuid
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Effective&nbsp;UID&nbsp;of&nbsp;creator&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            gid_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             cgid
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Effective&nbsp;GID&nbsp;of&nbsp;creator&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            unsigned&nbsp;short
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             mode
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Permissions&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            unsigned&nbsp;short
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             __seq
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Sequence&nbsp;number&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
           };
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </blockquote>
    </div>
    <p>
     Valid values for
     <em class="parameter">
      <code>
       cmd
      </code>
     </em>
     are:
    </p>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <code class="constant">
         IPC_STAT
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Copy information from the kernel data structure
            associated with
        <em class="parameter">
         <code>
          msqid
         </code>
        </em>
        into the
        <span class="structname">
         msqid_ds
        </span>
        structure
            pointed to by
        <em class="parameter">
         <code>
          buf
         </code>
        </em>
        . The caller must have
            read permission on the message queue.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         IPC_SET
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Write the values of some members of the
        <span class="structname">
         msqid_ds
        </span>
        structure pointed to by
        <em class="parameter">
         <code>
          buf
         </code>
        </em>
        to the
            kernel data structure associated with this message
            queue, updating also its
        <em class="parameter">
         <code>
          msg_ctime
         </code>
        </em>
        member. The
            following members of the structure are updated:
        <em class="parameter">
         <code>
          msg_qbytes
         </code>
        </em>
        ,
        <em class="replaceable">
         <code>
          msg_perm.uid
         </code>
        </em>
        ,
        <em class="replaceable">
         <code>
          msg_perm.gid
         </code>
        </em>
        ,
            and (the least significant 9 bits of)
        <em class="replaceable">
         <code>
          msg_perm.mode
         </code>
        </em>
        . The
            effective UID of the calling process must match the
            owner (
        <em class="replaceable">
         <code>
          msg_perm.uid
         </code>
        </em>
        ) or
            creator (
        <em class="replaceable">
         <code>
          msg_perm.cuid
         </code>
        </em>
        ) of the
            message queue, or the caller must be privileged.
            Appropriate privilege (Linux: the
        <code class="constant">
         CAP_SYS_RESOURCE
        </code>
        capability) is
            required to raise the
        <em class="parameter">
         <code>
          msg_qbytes
         </code>
        </em>
        value beyond
            the system parameter
        <code class="constant">
         MSGMNB
        </code>
        .
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         IPC_RMID
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Immediately remove the message queue, awakening all
            waiting reader and writer processes (with an error
            return and
        <code class="varname">
         errno
        </code>
        set to
        <span class="errorname">
         EIDRM
        </span>
        ). The calling
            process must have appropriate privileges or its
            effective user ID must be either that of the creator or
            owner of the message queue. The third argument to
        <code class="function">
         msgctl
        </code>
        () is ignored in
            this case.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         IPC_INFO
        </code>
        (Linux-specific)
       </span>
      </dt>
      <dd>
       <p>
        Return information about system-wide message queue
            limits and parameters in the structure pointed to by
        <em class="parameter">
         <code>
          buf
         </code>
        </em>
        . This
            structure is of type
        <em class="replaceable">
         <code>
          msginfo
         </code>
        </em>
        (thus, a cast
            is required), defined in
        <code class="literal">
         &lt;
        </code>
        <code class="filename">
         sys/msg.h
        </code>
        <code class="literal">
         &gt;
        </code>
        if the
        <code class="constant">
         _GNU_SOURCE
        </code>
        feature test macro is
            defined:
       </p>
       <div class="blockquote">
        <blockquote class="blockquote">
         <div class="structdef">
          <table style="border-collapse: collapse;">
           <colgroup span="1">
            <col class="c1" span="1">
            </col>
            <col class="c2" span="1">
            </col>
            <col class="c3" span="1">
            </col>
            <col class="c4" span="1">
            </col>
            <col class="c5" span="1">
            </col>
           </colgroup>
           <tbody>
            <tr>
             <td align="left" class="structdefhdr" colspan="1" rowspan="1" style="">
              struct
             </td>
             <td align="left" class="structdefhdr" colspan="4" rowspan="1" style="">
              <span class="structname">
               msginfo
              </span>
              &nbsp;{
             </td>
            </tr>
            <tr>
             <td colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <span class="type">
               int
              </span>
             </td>
             <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <em class="structfield">
               <code>
                msgpool
               </code>
              </em>
              ;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <div class="literallayout">
               /*&nbsp;Size&nbsp;in&nbsp;kibibytes&nbsp;of&nbsp;buffer&nbsp;pool
               <br/>
               used&nbsp;to&nbsp;hold&nbsp;message&nbsp;data;
               <br/>
               unused&nbsp;within&nbsp;kernel&nbsp;*/
              </div>
             </td>
            </tr>
            <tr>
             <td colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <span class="type">
               int
              </span>
             </td>
             <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <em class="structfield">
               <code>
                msgmap
               </code>
              </em>
              ;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <div class="literallayout">
               /*&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;message
               <br/>
               map;&nbsp;unused&nbsp;within&nbsp;kernel&nbsp;*/
              </div>
             </td>
            </tr>
            <tr>
             <td colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <span class="type">
               int
              </span>
             </td>
             <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <em class="structfield">
               <code>
                msgmax
               </code>
              </em>
              ;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <div class="literallayout">
               /*&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be
               <br/>
               written&nbsp;in&nbsp;a&nbsp;single&nbsp;message&nbsp;*/
              </div>
             </td>
            </tr>
            <tr>
             <td colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <span class="type">
               int
              </span>
             </td>
             <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <em class="structfield">
               <code>
                msgmnb
               </code>
              </em>
              ;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <div class="literallayout">
               /*&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be
               <br/>
               written&nbsp;to&nbsp;queue;&nbsp;used&nbsp;to&nbsp;initialize
               <br/>
               msg_qbytes&nbsp;during&nbsp;queue&nbsp;creation
               <br/>
               (msgget(2))&nbsp;*/
              </div>
             </td>
            </tr>
            <tr>
             <td colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <span class="type">
               int
              </span>
             </td>
             <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <em class="structfield">
               <code>
                msgmni
               </code>
              </em>
              ;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <div class="literallayout">
               /*&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;message&nbsp;queues&nbsp;*/
              </div>
             </td>
            </tr>
            <tr>
             <td colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <span class="type">
               int
              </span>
             </td>
             <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <em class="structfield">
               <code>
                msgssz
               </code>
              </em>
              ;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <div class="literallayout">
               /*&nbsp;Message&nbsp;segment&nbsp;size;
               <br/>
               unused&nbsp;within&nbsp;kernel&nbsp;*/
              </div>
             </td>
            </tr>
            <tr>
             <td colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <span class="type">
               int
              </span>
             </td>
             <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <em class="structfield">
               <code>
                msgtql
               </code>
              </em>
              ;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <div class="literallayout">
               /*&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;messages&nbsp;on&nbsp;all&nbsp;queues
               <br/>
               in&nbsp;system;&nbsp;unused&nbsp;within&nbsp;kernel&nbsp;*/
              </div>
             </td>
            </tr>
            <tr>
             <td colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <span class="type">
               unsigned&nbsp;short&nbsp;int
              </span>
             </td>
             <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
              &nbsp;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <em class="structfield">
               <code>
                msgseg
               </code>
              </em>
              ;
             </td>
             <td align="left" colspan="1" rowspan="1" style="">
              <div class="literallayout">
               /*&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;segments;
               <br/>
               unused&nbsp;within&nbsp;kernel&nbsp;*/
              </div>
             </td>
            </tr>
            <tr>
             <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
              };
             </td>
            </tr>
           </tbody>
          </table>
         </div>
        </blockquote>
       </div>
       <p>
        The
        <em class="parameter">
         <code>
          msgmni
         </code>
        </em>
        ,
        <em class="parameter">
         <code>
          msgmax
         </code>
        </em>
        , and
        <em class="parameter">
         <code>
          msgmnb
         </code>
        </em>
        settings
            can be changed via
        <code class="filename">
         /proc
        </code>
        files of the same name; see
        <a class="link" href="../htmlman5/proc.5.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           proc
          </span>
          (5)
         </span>
        </a>
        for
            details.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         MSG_INFO
        </code>
        (Linux-specific)
       </span>
      </dt>
      <dd>
       <p>
        Return a
        <em class="replaceable">
         <code>
          msginfo
         </code>
        </em>
        structure
            containing the same information as for
        <code class="constant">
         IPC_INFO
        </code>
        , except that the following
            fields are returned with information about system
            resources consumed by message queues: the
        <em class="parameter">
         <code>
          msgpool
         </code>
        </em>
        field returns the
            number of message queues that currently exist on the
            system; the
        <em class="parameter">
         <code>
          msgmap
         </code>
        </em>
        field returns the
            total number of messages in all queues on the system;
            and the
        <em class="parameter">
         <code>
          msgtql
         </code>
        </em>
        field returns the total number of bytes in all messages
            in all queues on the system.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         MSG_STAT
        </code>
        (Linux-specific)
       </span>
      </dt>
      <dd>
       <p>
        Return a
        <span class="structname">
         msqid_ds
        </span>
        structure as for
        <code class="constant">
         IPC_STAT
        </code>
        . However, the
        <em class="parameter">
         <code>
          msqid
         </code>
        </em>
        argument is not a
            queue identifier, but instead an index into the
            kernel's internal array that maintains information
            about all message queues on the system.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1">
    <a id="msgctl-2_sect2" name="msgctl-2_sect2" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     On success,
     <code class="constant">
      IPC_STAT
     </code>
     ,
     <code class="constant">
      IPC_SET
     </code>
     , and
     <code class="constant">
      IPC_RMID
     </code>
     return 0. A successful
     <code class="constant">
      IPC_INFO
     </code>
     or
     <code class="constant">
      MSG_INFO
     </code>
     operation returns the index of the
      highest used entry in the kernel's internal array recording
      information about all message queues. (This information can
      be used with repeated
     <code class="constant">
      MSG_STAT
     </code>
     operations to obtain information about all queues on the
      system.) A successful
     <code class="constant">
      MSG_STAT
     </code>
     operation returns the identifier of the queue whose index was
      given in
     <em class="parameter">
      <code>
       msqid
      </code>
     </em>
     .
    </p>
    <p>
     On error, &minus;1 is returned with
     <code class="varname">
      errno
     </code>
     indicating the error.
    </p>
   </div>
   <div class="refsect1">
    <a id="msgctl-2_sect3" name="msgctl-2_sect3" shape="rect">
    </a>
    <h2>
     ERRORS
    </h2>
    <p>
     On failure,
     <code class="varname">
      errno
     </code>
     is set to
      one of the following:
    </p>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <span class="errorname">
         EACCES
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The argument
        <em class="parameter">
         <code>
          cmd
         </code>
        </em>
        is equal to
        <code class="constant">
         IPC_STAT
        </code>
        or
        <code class="constant">
         MSG_STAT
        </code>
        , but the calling process
            does not have read permission on the message queue
        <em class="parameter">
         <code>
          msqid
         </code>
        </em>
        , and does
            not have the
        <code class="constant">
         CAP_IPC_OWNER
        </code>
        capability.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EFAULT
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The argument
        <em class="parameter">
         <code>
          cmd
         </code>
        </em>
        has the value
        <code class="constant">
         IPC_SET
        </code>
        or
        <code class="constant">
         IPC_STAT
        </code>
        , but the address pointed to
            by
        <em class="parameter">
         <code>
          buf
         </code>
        </em>
        isn't
            accessible.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EIDRM
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The message queue was removed.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EINVAL
        </span>
       </span>
      </dt>
      <dd>
       <p>
        Invalid value for
        <em class="parameter">
         <code>
          cmd
         </code>
        </em>
        or
        <em class="parameter">
         <code>
          msqid
         </code>
        </em>
        . Or: for a
        <code class="constant">
         MSG_STAT
        </code>
        operation, the
            index value specified in
        <em class="parameter">
         <code>
          msqid
         </code>
        </em>
        referred to an
            array slot that is currently unused.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EPERM
        </span>
       </span>
      </dt>
      <dd>
       <p>
        The argument
        <em class="parameter">
         <code>
          cmd
         </code>
        </em>
        has the value
        <code class="constant">
         IPC_SET
        </code>
        or
        <code class="constant">
         IPC_RMID
        </code>
        , but the effective user ID
            of the calling process is not the creator (as found in
        <em class="replaceable">
         <code>
          msg_perm.cuid
         </code>
        </em>
        ) or the
            owner (as found in
        <em class="replaceable">
         <code>
          msg_perm.uid
         </code>
        </em>
        ) of the
            message queue, and the caller is not privileged (Linux:
            does not have the
        <code class="constant">
         CAP_SYS_ADMIN
        </code>
        capability).
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EPERM
        </span>
       </span>
      </dt>
      <dd>
       <p>
        An attempt (
        <code class="constant">
         IPC_SET
        </code>
        )
            was made to increase
        <em class="parameter">
         <code>
          msg_qbytes
         </code>
        </em>
        beyond the
            system parameter
        <code class="constant">
         MSGMNB
        </code>
        ,
            but the caller is not privileged (Linux: does not have
            the
        <code class="constant">
         CAP_SYS_RESOURCE
        </code>
        capability).
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1">
    <a id="msgctl-2_sect4" name="msgctl-2_sect4" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     SVr4, POSIX.1-2001.
    </p>
   </div>
   <div class="refsect1">
    <a id="msgctl-2_sect5" name="msgctl-2_sect5" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     The inclusion of
     <code class="literal">
      &lt;
     </code>
     <code class="filename">
      sys/types.h
     </code>
     <code class="literal">
      &gt;
     </code>
     and
     <code class="literal">
      &lt;
     </code>
     <code class="filename">
      sys/ipc.h
     </code>
     <code class="literal">
      &gt;
     </code>
     isn't required on Linux or by any version of POSIX. However,
      some old implementations required the inclusion of these
      header files, and the SVID also documented their inclusion.
      Applications intended to be portable to such old systems may
      need to include these header files.
    </p>
    <p>
     The
     <code class="constant">
      IPC_INFO
     </code>
     ,
     <code class="constant">
      MSG_STAT
     </code>
     and
     <code class="constant">
      MSG_INFO
     </code>
     operations are used by the
     <a class="link" href="../htmlman1/ipcs.1.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        ipcs
       </span>
       (1)
      </span>
     </a>
     program to provide
      information on allocated resources. In the future these may
      modified or moved to a
     <code class="filename">
      /proc
     </code>
     filesystem interface.
    </p>
    <p>
     Various fields in the
     <span class="emphasis">
      <em>
       struct
      msqid_ds
      </em>
     </span>
     were typed as
     <span class="type">
      short
     </span>
     under Linux 2.2 and have become
     <span class="type">
      long
     </span>
     under Linux 2.4. To take
      advantage of this, a recompilation under glibc-2.1.91 or
      later should suffice. (The kernel distinguishes old and new
      calls by an
     <code class="constant">
      IPC_64
     </code>
     flag in
     <em class="parameter">
      <code>
       cmd
      </code>
     </em>
     .)
    </p>
   </div>
   <div class="refsect1">
    <a id="msgctl-2_sect6" name="msgctl-2_sect6" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman2/msgget.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        msgget
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/msgop.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        msgrcv
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/msgop.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        msgsnd
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/capabilities.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        capabilities
       </span>
       (7)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/mq_overview.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        mq_overview
       </span>
       (7)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/svipc.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        svipc
       </span>
       (7)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="msgctl-2_sect7" name="msgctl-2_sect7" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
