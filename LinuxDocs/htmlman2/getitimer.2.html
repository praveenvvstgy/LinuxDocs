<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   getitimer(2) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="getitimer(2) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="getitimer.2" name="getitimer.2" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     getitimer, setitimer &mdash; get or set value of an
      interval timer
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="funcsynopsis">
     <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;sys/time.h&gt;
</pre>
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          getitimer
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         which
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        struct itimerval *
        <var class="pdparam">
         curr_value
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         int
         <strong>
          setitimer
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         which
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        const struct itimerval *
        <var class="pdparam">
         new_value
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        struct itimerval *
        <var class="pdparam">
         old_value
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
   </div>
   <div class="refsect1">
    <a id="getitimer-2_sect1" name="getitimer-2_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     The system provides each process with three interval
      timers, each decrementing in a distinct time domain. When a
      timer expires, a signal is sent to the process, and the timer
      is reset to the specified interval (if nonzero).
    </p>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <code class="constant">
         ITIMER_REAL
        </code>
       </span>
      </dt>
      <dd>
       <p>
        decrements in real time, and delivers
        <code class="constant">
         SIGALRM
        </code>
        upon expiration.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         ITIMER_VIRTUAL
        </code>
       </span>
      </dt>
      <dd>
       <p>
        decrements only when the process is executing, and
            delivers
        <code class="constant">
         SIGVTALRM
        </code>
        upon
            expiration.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         ITIMER_PROF
        </code>
       </span>
      </dt>
      <dd>
       <p>
        decrements both when the process executes and when
            the system is executing on behalf of the process.
            Coupled with
        <code class="constant">
         ITIMER_VIRTUAL
        </code>
        , this timer is usually
            used to profile the time spent by the application in
            user and kernel space.
        <code class="constant">
         SIGPROF
        </code>
        is delivered upon
            expiration.
       </p>
      </dd>
     </dl>
    </div>
    <p>
     Timer values are defined by the following structures:
    </p>
    <div class="blockquote">
     <blockquote class="blockquote">
      <div class="structdef">
       <table style="border-collapse: collapse;">
        <colgroup span="1">
         <col class="c1" span="1">
         </col>
         <col class="c2" span="1">
         </col>
         <col class="c3" span="1">
         </col>
         <col class="c4" span="1">
         </col>
         <col class="c5" span="1">
         </col>
        </colgroup>
        <tbody>
         <tr>
          <td align="left" class="structdefhdr" colspan="1" rowspan="1" style="">
           struct
          </td>
          <td align="left" class="structdefhdr" colspan="4" rowspan="1" style="">
           <span class="structname">
            itimerval
           </span>
           &nbsp;{
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            struct&nbsp;timeval
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             it_interval
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Interval&nbsp;for&nbsp;periodic&nbsp;timer&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            struct&nbsp;timeval
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             it_value
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;Time&nbsp;until&nbsp;next&nbsp;expiration&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
           };
          </td>
         </tr>
         <tr>
          <td align="left" class="structsep" colspan="5" rowspan="1" style="">
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefhdr2" colspan="1" rowspan="1" style="">
           struct
          </td>
          <td align="left" class="structdefhdr2" colspan="4" rowspan="1" style="">
           <span class="structname">
            timeval
           </span>
           &nbsp;{
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            time_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             tv_sec
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;seconds&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <span class="type">
            suseconds_t
           </span>
          </td>
          <td align="right" class="norightpad" colspan="1" rowspan="1" style="">
           &nbsp;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <em class="structfield">
            <code>
             tv_usec
            </code>
           </em>
           ;
          </td>
          <td align="left" colspan="1" rowspan="1" style="">
           <div class="literallayout">
            /*&nbsp;microseconds&nbsp;*/
           </div>
          </td>
         </tr>
         <tr>
          <td align="left" class="structdefftr" colspan="5" rowspan="1" style="">
           };
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </blockquote>
    </div>
    <p>
     The function
     <code class="function">
      getitimer
     </code>
     ()
      fills the structure pointed to by
     <em class="parameter">
      <code>
       curr_value
      </code>
     </em>
     with the current
      value (i.e., the amount of time remaining until the next
      expiration) of the timer specified by
     <em class="parameter">
      <code>
       which
      </code>
     </em>
     (one of
     <code class="constant">
      ITIMER_REAL
     </code>
     ,
     <code class="constant">
      ITIMER_VIRTUAL
     </code>
     , or
     <code class="constant">
      ITIMER_PROF
     </code>
     ). The subfields of the field
     <em class="parameter">
      <code>
       it_value
      </code>
     </em>
     are set to
      the amount of time remaining on the timer, or zero if the
      timer is disabled. The
     <em class="parameter">
      <code>
       it_interval
      </code>
     </em>
     field is set to the
      timer interval (period); a value of zero returned in (both
      subfields of) this field indicates that this is a single-shot
      timer.
    </p>
    <p>
     The function
     <code class="function">
      setitimer
     </code>
     ()
      sets the specified timer to the value in
     <em class="parameter">
      <code>
       new_value
      </code>
     </em>
     . If
     <em class="parameter">
      <code>
       old_value
      </code>
     </em>
     is non-NULL, the old
      value of the timer (i.e., the same information as returned by
     <code class="function">
      getitimer
     </code>
     ()) is stored
      there.
    </p>
    <p>
     Timers decrement from
     <em class="parameter">
      <code>
       it_value
      </code>
     </em>
     to zero, generate a
      signal, and reset to
     <em class="parameter">
      <code>
       it_interval
      </code>
     </em>
     . A timer which is
      set to zero (
     <em class="parameter">
      <code>
       it_value
      </code>
     </em>
     is zero or the timer expires and
     <em class="parameter">
      <code>
       it_interval
      </code>
     </em>
     is zero) stops.
    </p>
    <p>
     Both
     <em class="parameter">
      <code>
       tv_sec
      </code>
     </em>
     and
     <em class="parameter">
      <code>
       tv_usec
      </code>
     </em>
     are
      significant in determining the duration of a timer.
    </p>
    <p>
     Timers will never expire before the requested time, but
      may expire some (short) time afterward, which depends on the
      system timer resolution and on the system load; see
     <a class="link" href="../htmlman7/time.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        time
       </span>
       (7)
      </span>
     </a>
     . (But see BUGS
      below.) Upon expiration, a signal will be generated and the
      timer reset. If the timer expires while the process is active
      (always true for
     <code class="constant">
      ITIMER_VIRTUAL
     </code>
     ), the signal will be
      delivered immediately when generated. Otherwise, the delivery
      will be offset by a small time dependent on the system
      loading.
    </p>
   </div>
   <div class="refsect1">
    <a id="getitimer-2_sect2" name="getitimer-2_sect2" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     On success, zero is returned. On error, &minus;1 is
      returned, and
     <code class="varname">
      errno
     </code>
     is set
      appropriately.
    </p>
   </div>
   <div class="refsect1">
    <a id="getitimer-2_sect3" name="getitimer-2_sect3" shape="rect">
    </a>
    <h2>
     ERRORS
    </h2>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <span class="errorname">
         EFAULT
        </span>
       </span>
      </dt>
      <dd>
       <p>
        <em class="parameter">
         <code>
          new_value
         </code>
        </em>
        ,
        <em class="parameter">
         <code>
          old_value
         </code>
        </em>
        , or
        <em class="parameter">
         <code>
          curr_value
         </code>
        </em>
        is
            not valid a pointer.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EINVAL
        </span>
       </span>
      </dt>
      <dd>
       <p>
        <em class="parameter">
         <code>
          which
         </code>
        </em>
        is not
            one of
        <code class="constant">
         ITIMER_REAL
        </code>
        ,
        <code class="constant">
         ITIMER_VIRTUAL
        </code>
        , or
        <code class="constant">
         ITIMER_PROF
        </code>
        ; or (since
            Linux 2.6.22) one of the
        <em class="parameter">
         <code>
          tv_usec
         </code>
        </em>
        fields in the
            structure pointed to by
        <em class="parameter">
         <code>
          new_value
         </code>
        </em>
        contains a
            value outside the range 0 to 999999.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1">
    <a id="getitimer-2_sect4" name="getitimer-2_sect4" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     POSIX.1-2001, SVr4, 4.4BSD (this call first appeared in
      4.2BSD). POSIX.1-2008 marks
     <code class="function">
      getitimer
     </code>
     () and
     <code class="function">
      setitimer
     </code>
     () obsolete, recommending the use
      of the POSIX timers API (
     <a class="link" href="../htmlman2/timer_settime.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        timer_gettime
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/timer_settime.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        timer_settime
       </span>
       (2)
      </span>
     </a>
     , etc.)
      instead.
    </p>
   </div>
   <div class="refsect1">
    <a id="getitimer-2_sect5" name="getitimer-2_sect5" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     A child created via
     <a class="link" href="../htmlman2/fork.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        fork
       </span>
       (2)
      </span>
     </a>
     does not inherit
      its parent's interval timers. Interval timers are preserved
      across an
     <a class="link" href="../htmlman2/execve.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        execve
       </span>
       (2)
      </span>
     </a>
     .
    </p>
    <p>
     POSIX.1 leaves the interaction between
     <code class="function">
      setitimer
     </code>
     () and the three interfaces
     <a class="link" href="../htmlman2/alarm.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        alarm
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman3/sleep.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        sleep
       </span>
       (3)
      </span>
     </a>
     , and
     <a class="link" href="../htmlman3/usleep.3.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        usleep
       </span>
       (3)
      </span>
     </a>
     unspecified.
    </p>
    <p>
     The standards are silent on the meaning of the call:
    </p>
    <p>
     setitimer(which, NULL, &amp;old_value);
    </p>
    <p>
     Many systems (Solaris, the BSDs, and perhaps others) treat
      this as equivalent to:
    </p>
    <p>
     getitimer(which, &amp;old_value);
    </p>
    <p>
     In Linux, this is treated as being equivalent to a call in
      which the
     <em class="parameter">
      <code>
       new_value
      </code>
     </em>
     fields are zero; that is, the timer is disabled.
     <span class="emphasis">
      <em>
       Don't use this Linux misfeature
      </em>
     </span>
     :
      it is nonportable and unnecessary.
    </p>
   </div>
   <div class="refsect1">
    <a id="getitimer-2_sect6" name="getitimer-2_sect6" shape="rect">
    </a>
    <h2>
     BUGS
    </h2>
    <p>
     The generation and delivery of a signal are distinct, and
      only one instance of each of the signals listed above may be
      pending for a process. Under very heavy loading, an
     <code class="constant">
      ITIMER_REAL
     </code>
     timer may expire
      before the signal from a previous expiration has been
      delivered. The second signal in such an event will be
      lost.
    </p>
    <p>
     On Linux kernels before 2.6.16, timer values are
      represented in jiffies. If a request is made set a timer with
      a value whose jiffies representation exceeds
     <code class="constant">
      MAX_SEC_IN_JIFFIES
     </code>
     (defined in
     <code class="filename">
      include/linux/jiffies.h
     </code>
     ), then the timer is
      silently truncated to this ceiling value. On Linux/i386
      (where, since Linux 2.6.13, the default jiffy is 0.004
      seconds), this means that the ceiling value for a timer is
      approximately 99.42 days. Since Linux 2.6.16, the kernel uses
      a different internal representation for times, and this
      ceiling is removed.
    </p>
    <p>
     On certain systems (including i386), Linux kernels before
      version 2.6.12 have a bug which will produce premature timer
      expirations of up to one jiffy under some circumstances. This
      bug is fixed in kernel 2.6.12.
    </p>
    <p>
     POSIX.1-2001 says that
     <code class="function">
      setitimer
     </code>
     () should fail if a
     <em class="parameter">
      <code>
       tv_usec
      </code>
     </em>
     value is specified that
      is outside of the range 0 to 999999. However, in kernels up
      to and including 2.6.21, Linux does not give an error, but
      instead silently adjusts the corresponding seconds value for
      the timer. From kernel 2.6.22 onward, this nonconformance has
      been repaired: an improper
     <em class="parameter">
      <code>
       tv_usec
      </code>
     </em>
     value results in an
     <span class="errorname">
      EINVAL
     </span>
     error.
    </p>
   </div>
   <div class="refsect1">
    <a id="getitimer-2_sect7" name="getitimer-2_sect7" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman2/gettimeofday.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        gettimeofday
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/sigaction.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        sigaction
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/signal.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        signal
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/timer_create.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        timer_create
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/timerfd_create.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        timerfd_create
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman7/time.7.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        time
       </span>
       (7)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="getitimer-2_sect8" name="getitimer-2_sect8" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
