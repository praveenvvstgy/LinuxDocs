<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   tee(2) &mdash; Linux manual pages
  </title>
  <link href="../stylesheet/manpages.css" rel="stylesheet" type="text/css"/>
  <link href="../index.html" rel="home" title="tee(2) &mdash; Linux manual pages"/>
  <script src="../stylesheet/manpages.js" type="text/javascript" xml:space="preserve">
  </script>
  <link href="../stylesheet/icon.gif" rel="icon" type="image/gif"/>
 </head>
 <body>
  <div class="refentry">
   <a id="tee.2" name="tee.2" shape="rect">
   </a>
   <div class="titlepage">
   </div>
   <div class="refnamediv">
    <h2>
     Name
    </h2>
    <p>
     tee &mdash; duplicating pipe content
    </p>
   </div>
   <div class="refsynopsisdiv">
    <h2>
     Synopsis
    </h2>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
#define _GNU_SOURCE          /* See feature_test_macros(7) */
#include &lt;fcntl.h&gt;
</pre>
    </div>
    <div class="funcsynopsis">
     <table border="0" class="funcprototype-table" style="cellspacing: 0; cellpadding: 0;" summary="Function synopsis">
      <tr>
       <td colspan="1" rowspan="1">
        <code class="funcdef">
         ssize_t
         <strong>
          tee
         </strong>
         (
        </code>
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         fd_in
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        int
        <var class="pdparam">
         fd_out
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        size_t
        <var class="pdparam">
         len
        </var>
        ,
       </td>
      </tr>
      <tr>
       <td colspan="1" rowspan="1">
        &nbsp;
       </td>
       <td colspan="1" rowspan="1">
        unsigned int
        <var class="pdparam">
         flags
        </var>
        <code>
         )
        </code>
        ;
       </td>
      </tr>
     </table>
     <div class="funcprototype-spacer">
      &nbsp;
     </div>
    </div>
   </div>
   <div class="refsect1">
    <a id="tee-2_sect1" name="tee-2_sect1" shape="rect">
    </a>
    <h2>
     DESCRIPTION
    </h2>
    <p>
     <code class="function">
      tee
     </code>
     () duplicates up to
     <em class="parameter">
      <code>
       len
      </code>
     </em>
     bytes of data
      from the pipe referred to by the file descriptor
     <em class="parameter">
      <code>
       fd_in
      </code>
     </em>
     to the pipe referred to
      by the file descriptor
     <em class="parameter">
      <code>
       fd_out
      </code>
     </em>
     . It does not consume the
      data that is duplicated from
     <em class="parameter">
      <code>
       fd_in
      </code>
     </em>
     ; therefore, that data can
      be copied by a subsequent
     <a class="link" href="../htmlman2/splice.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        splice
       </span>
       (2)
      </span>
     </a>
     .
    </p>
    <p>
     <em class="parameter">
      <code>
       flags
      </code>
     </em>
     is a series
      of modifier flags, which share the name space with
     <a class="link" href="../htmlman2/splice.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        splice
       </span>
       (2)
      </span>
     </a>
     and
     <a class="link" href="../htmlman2/vmsplice.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        vmsplice
       </span>
       (2)
      </span>
     </a>
     :
    </p>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <code class="constant">
         SPLICE_F_MOVE
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Currently has no effect for
        <code class="function">
         tee
        </code>
        (); see
        <a class="link" href="../htmlman2/splice.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           splice
          </span>
          (2)
         </span>
        </a>
        .
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         SPLICE_F_NONBLOCK
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Do not block on I/O; see
        <a class="link" href="../htmlman2/splice.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           splice
          </span>
          (2)
         </span>
        </a>
        for further
            details.
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         SPLICE_F_MORE
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Currently has no effect for
        <code class="function">
         tee
        </code>
        (), but may be implemented in the
            future; see
        <a class="link" href="../htmlman2/splice.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           splice
          </span>
          (2)
         </span>
        </a>
        .
       </p>
      </dd>
      <dt>
       <span class="term">
        <code class="constant">
         SPLICE_F_GIFT
        </code>
       </span>
      </dt>
      <dd>
       <p>
        Unused for
        <code class="function">
         tee
        </code>
        (); see
        <a class="link" href="../htmlman2/vmsplice.2.html" shape="rect" target="_top">
         <span class="citerefentry">
          <span class="refentrytitle">
           vmsplice
          </span>
          (2)
         </span>
        </a>
        .
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1">
    <a id="tee-2_sect2" name="tee-2_sect2" shape="rect">
    </a>
    <h2>
     RETURN VALUE
    </h2>
    <p>
     Upon successful completion,
     <code class="function">
      tee
     </code>
     () returns the number of bytes that were
      duplicated between the input and output. A return value of 0
      means that there was no data to transfer, and it would not
      make sense to block, because there are no writers connected
      to the write end of the pipe referred to by
     <em class="parameter">
      <code>
       fd_in
      </code>
     </em>
     .
    </p>
    <p>
     On error,
     <code class="function">
      tee
     </code>
     () returns
      &minus;1 and
     <code class="varname">
      errno
     </code>
     is set to
      indicate the error.
    </p>
   </div>
   <div class="refsect1">
    <a id="tee-2_sect3" name="tee-2_sect3" shape="rect">
    </a>
    <h2>
     ERRORS
    </h2>
    <div class="variablelist">
     <dl class="variablelist">
      <dt>
       <span class="term">
        <span class="errorname">
         EAGAIN
        </span>
       </span>
      </dt>
      <dd>
       <p>
        <code class="constant">
         SPLICE_F_NONBLOCK
        </code>
        was
            specified in
        <em class="parameter">
         <code>
          flags
         </code>
        </em>
        , and the operation
            would block.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         EINVAL
        </span>
       </span>
      </dt>
      <dd>
       <p>
        <em class="parameter">
         <code>
          fd_in
         </code>
        </em>
        or
        <em class="parameter">
         <code>
          fd_out
         </code>
        </em>
        does not
            refer to a pipe; or
        <em class="parameter">
         <code>
          fd_in
         </code>
        </em>
        and
        <em class="parameter">
         <code>
          fd_out
         </code>
        </em>
        refer to the same
            pipe.
       </p>
      </dd>
      <dt>
       <span class="term">
        <span class="errorname">
         ENOMEM
        </span>
       </span>
      </dt>
      <dd>
       <p>
        Out of memory.
       </p>
      </dd>
     </dl>
    </div>
   </div>
   <div class="refsect1">
    <a id="tee-2_sect4" name="tee-2_sect4" shape="rect">
    </a>
    <h2>
     VERSIONS
    </h2>
    <p>
     The
     <code class="function">
      tee
     </code>
     () system call first
      appeared in Linux 2.6.17; library support was added to glibc
      in version 2.5.
    </p>
   </div>
   <div class="refsect1">
    <a id="tee-2_sect5" name="tee-2_sect5" shape="rect">
    </a>
    <h2>
     CONFORMING TO
    </h2>
    <p>
     This system call is Linux-specific.
    </p>
   </div>
   <div class="refsect1">
    <a id="tee-2_sect6" name="tee-2_sect6" shape="rect">
    </a>
    <h2>
     NOTES
    </h2>
    <p>
     Conceptually,
     <code class="function">
      tee
     </code>
     () copies
      the data between the two pipes. In reality no real data
      copying takes place though: under the covers,
     <code class="function">
      tee
     </code>
     () assigns data in the output by merely
      grabbing a reference to the input.
    </p>
   </div>
   <div class="refsect1">
    <a id="tee-2_sect7" name="tee-2_sect7" shape="rect">
    </a>
    <h2>
     EXAMPLE
    </h2>
    <p>
     The following example implements a basic
     <a class="link" href="../htmlman1/tee.1.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        tee
       </span>
       (1)
      </span>
     </a>
     program using the
     <code class="function">
      tee
     </code>
     () system call.
    </p>
    <div class="informalexample">
     <pre class="programlisting" xml:space="preserve">
#define _GNU_SOURCE
#include &lt;fcntl.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;errno.h&gt;
#include &lt;limits.h&gt;

int
main(int argc, char *argv[])
{
    int fd;
    int len, slen;

    if (argc != 2) {
        fprintf(stderr, "Usage: %s &lt;file&gt;\n", argv[0]);
        exit(EXIT_FAILURE);
    }

    fd = open(argv[1], O_WRONLY | O_CREAT | O_TRUNC, 0644);
    if (fd == &minus;1) {
        perror("open");
        exit(EXIT_FAILURE);
    }

    do {
        /*
         * tee stdin to stdout.
         */
        len = tee(STDIN_FILENO, STDOUT_FILENO,
                  INT_MAX, SPLICE_F_NONBLOCK);

        if (len &lt; 0) {
            if (errno == EAGAIN)
                continue;
            perror("tee");
            exit(EXIT_FAILURE);
        } else
            if (len == 0)
                break;

        /*
         * Consume stdin by splicing it to a file.
         */
        while (len &gt; 0) {
            slen = splice(STDIN_FILENO, NULL, fd, NULL,
                          len, SPLICE_F_MOVE);
            if (slen &lt; 0) {
                perror("splice");
                break;
            }
            len &minus;= slen;
        }
    } while (1);

    close(fd);
    exit(EXIT_SUCCESS);
}
</pre>
    </div>
   </div>
   <div class="refsect1">
    <a id="tee-2_sect8" name="tee-2_sect8" shape="rect">
    </a>
    <h2>
     SEE ALSO
    </h2>
    <p>
     <a class="link" href="../htmlman2/splice.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        splice
       </span>
       (2)
      </span>
     </a>
     ,
     <a class="link" href="../htmlman2/vmsplice.2.html" shape="rect" target="_top">
      <span class="citerefentry">
       <span class="refentrytitle">
        vmsplice
       </span>
       (2)
      </span>
     </a>
    </p>
   </div>
   <div class="colophon">
    <a id="tee-2_sect9" name="tee-2_sect9" shape="rect">
    </a>
    <h2>
     COLOPHON
    </h2>
    <p>
     This page is part of release 3.72 of the Linux
     <em class="replaceable">
      <code>
       man-pages
      </code>
     </em>
     project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man&minus;pages/.
    </p>
   </div>
  </div>
 </body>
</html>
